(()=>{"use strict";let e;const t="fast-kernel";try{if(document.currentScript)e=document.currentScript.getAttribute(t);else{const n=document.getElementsByTagName("script");e=n[n.length-1].getAttribute(t)}}catch(t){e="isolate"}let n;switch(e){case"share":n=Object.freeze({updateQueue:1,observable:2,contextEvent:3,elementRegistry:4});break;case"share-v2":n=Object.freeze({updateQueue:1.2,observable:2.2,contextEvent:3.2,elementRegistry:4.2});break;default:const e=`-${Math.random().toString(36).substring(2,8)}`;n=Object.freeze({updateQueue:`1.2${e}`,observable:`2.2${e}`,contextEvent:`3.2${e}`,elementRegistry:`4.2${e}`})}const i=e=>"function"==typeof e,r=e=>"string"==typeof e,s=()=>{};class o{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.subject=e,this.sub1=t}has(e){return void 0===this.spillover?this.sub1===e||this.sub2===e:-1!==this.spillover.indexOf(e)}subscribe(e){const t=this.spillover;if(void 0===t){if(this.has(e))return;if(void 0===this.sub1)return void(this.sub1=e);if(void 0===this.sub2)return void(this.sub2=e);this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else-1===t.indexOf(e)&&t.push(e)}unsubscribe(e){const t=this.spillover;if(void 0===t)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}notify(e){const t=this.spillover,n=this.subject;if(void 0===t){const t=this.sub1,i=this.sub2;void 0!==t&&t.handleChange(n,e),void 0!==i&&i.handleChange(n,e)}else for(let i=0,r=t.length;i<r;++i)t[i].handleChange(n,e)}}class a{constructor(e){this.subscribers={},this.subjectSubscribers=null,this.subject=e}notify(e){var t,n;null===(t=this.subscribers[e])||void 0===t||t.notify(e),null===(n=this.subjectSubscribers)||void 0===n||n.notify(e)}subscribe(e,t){var n,i;let r;r=t?null!==(n=this.subscribers[t])&&void 0!==n?n:this.subscribers[t]=new o(this.subject):null!==(i=this.subjectSubscribers)&&void 0!==i?i:this.subjectSubscribers=new o(this.subject),r.subscribe(e)}unsubscribe(e,t){var n,i;t?null===(n=this.subscribers[t])||void 0===n||n.unsubscribe(e):null===(i=this.subjectSubscribers)||void 0===i||i.unsubscribe(e)}}!function(){if("undefined"==typeof globalThis)if("undefined"!=typeof global)global.globalThis=global;else if("undefined"!=typeof self)self.globalThis=self;else if("undefined"!=typeof window)window.globalThis=window;else{const e=new Function("return this")();e.globalThis=e}}();const l={configurable:!1,enumerable:!1,writable:!1};void 0===globalThis.FAST&&Reflect.defineProperty(globalThis,"FAST",Object.assign({value:Object.create(null)},l));const d=globalThis.FAST;if(void 0===d.getById){const e=Object.create(null);Reflect.defineProperty(d,"getById",Object.assign({value(t,n){let i=e[t];return void 0===i&&(i=n?e[t]=n():null),i}},l))}function h(){const e=new Map;return Object.freeze({register:t=>!e.has(t.type)&&(e.set(t.type,t),!0),getByType:t=>e.get(t),getForInstance(t){if(null!=t)return e.get(t.constructor)}})}function c(){const e=new WeakMap;return function(t){let n=e.get(t);if(void 0===n){let i=Reflect.getPrototypeOf(t);for(;void 0===n&&null!==i;)n=e.get(i),i=Reflect.getPrototypeOf(i);n=void 0===n?[]:n.slice(0),e.set(t,n)}return n}}function u(e){e.prototype.toJSON=s}void 0===d.error&&Object.assign(d,{warn(){},error:e=>new Error(`Error ${e}`),addMessages(){}}),Object.freeze([]);const p=d.getById(n.updateQueue,(()=>{const e=[],t=[],n=globalThis.requestAnimationFrame;let i=!0;function r(){if(t.length)throw t.shift()}function s(n){try{n.call()}catch(n){if(!i)throw e.length=0,n;t.push(n),setTimeout(r,0)}}function o(){let t=0;for(;t<e.length;)if(s(e[t]),t++,t>1024){for(let n=0,i=e.length-t;n<i;n++)e[n]=e[n+t];e.length-=t,t=0}e.length=0}function a(t){e.push(t),e.length<2&&(i?n(o):o())}return Object.freeze({enqueue:a,next:()=>new Promise(a),process:o,setMode:e=>i=e})})),g=Object.freeze({unknown:void 0,coupled:1}),f=d.getById(n.observable,(()=>{const e=p.enqueue,t=/(:|&&|\|\||if|\?\.)/,n=new WeakMap;let s,l=e=>{throw d.error(1101)};function h(e){var t;let i=null!==(t=e.$fastController)&&void 0!==t?t:n.get(e);return void 0===i&&(Array.isArray(e)?i=l(e):n.set(e,i=new a(e))),i}const f=c();class m{constructor(e){this.name=e,this.field=`_${e}`,this.callback=`${e}Changed`}getValue(e){return void 0!==s&&s.watch(e,this.name),e[this.field]}setValue(e,t){const n=this.field,r=e[n];if(r!==t){e[n]=t;const s=e[this.callback];i(s)&&s.call(e,r,t),h(e).notify(this.name)}}}class v extends o{constructor(e,t,n=!1){super(e,t),this.expression=e,this.isVolatileBinding=n,this.needsRefresh=!0,this.needsQueue=!0,this.isAsync=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}setMode(e){this.isAsync=this.needsQueue=e}bind(e){this.controller=e;const t=this.observe(e.source,e.context);return!e.isBound&&this.requiresUnbind(e)&&e.onUnbind(this),t}requiresUnbind(e){return e.sourceLifetime!==g.coupled||this.first!==this.last||this.first.propertySource!==e.source}unbind(e){this.dispose()}observe(e,t){this.needsRefresh&&null!==this.last&&this.dispose();const n=s;let i;s=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;try{i=this.expression(e,t)}finally{s=n}return i}disconnect(){this.dispose()}dispose(){if(null!==this.last){let e=this.first;for(;void 0!==e;)e.notifier.unsubscribe(this,e.propertyName),e=e.next;this.last=null,this.needsRefresh=this.needsQueue=this.isAsync}}watch(e,t){const n=this.last,i=h(e),r=null===n?this.first:{};if(r.propertySource=e,r.propertyName=t,r.notifier=i,i.subscribe(this,t),null!==n){if(!this.needsRefresh){let t;s=void 0,t=n.propertySource[n.propertyName],s=this,e===t&&(this.needsRefresh=!0)}n.next=r}this.last=r}handleChange(){this.needsQueue?(this.needsQueue=!1,e(this)):this.isAsync||this.call()}call(){null!==this.last&&(this.needsQueue=this.isAsync,this.notify(this))}*records(){let e=this.first;for(;void 0!==e;)yield e,e=e.next}}return u(v),Object.freeze({setArrayObserverFactory(e){l=e},getNotifier:h,track(e,t){s&&s.watch(e,t)},trackVolatile(){s&&(s.needsRefresh=!0)},notify(e,t){h(e).notify(t)},defineProperty(e,t){r(t)&&(t=new m(t)),f(e).push(t),Reflect.defineProperty(e,t.name,{enumerable:!0,get(){return t.getValue(this)},set(e){t.setValue(this,e)}})},getAccessors:f,binding(e,t,n=this.isVolatileBinding(e)){return new v(e,t,n)},isVolatileBinding:e=>t.test(e.toString())})})),m=d.getById(n.contextEvent,(()=>{let e=null;return{get:()=>e,set(t){e=t}}})),v=Object.freeze({default:{index:0,length:0,get event(){return v.getEvent()},eventDetail(){return this.event.detail},eventTarget(){return this.event.target}},getEvent:()=>m.get(),setEvent(e){m.set(e)}});let b;function y(e){return e.map((e=>e instanceof w?y(e.styles):[e])).reduce(((e,t)=>e.concat(t)),[])}class w{constructor(e){this.styles=e,this.targets=new WeakSet,this._strategy=null,this.behaviors=e.map((e=>e instanceof w?e.behaviors:null)).reduce(((e,t)=>null===t?e:null===e?t:e.concat(t)),null)}get strategy(){return null===this._strategy&&this.withStrategy(b),this._strategy}addStylesTo(e){this.strategy.addStylesTo(e),this.targets.add(e)}removeStylesFrom(e){this.strategy.removeStylesFrom(e),this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=null===this.behaviors?e:this.behaviors.concat(e),this}withStrategy(e){return this._strategy=new e(y(this.styles)),this}static setDefaultStrategy(e){b=e}static normalize(e){return void 0===e?void 0:Array.isArray(e)?new w(e):e instanceof w?e:new w([e])}}w.supportsAdoptedStyleSheets=Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype;const E=Object.freeze({none:0,attribute:1,booleanAttribute:2,property:3,content:4,tokenList:5,event:6}),S=e=>e,x=globalThis.trustedTypes?globalThis.trustedTypes.createPolicy("fast-html",{createHTML:S}):{createHTML:S};let T=Object.freeze({createHTML:e=>x.createHTML(e),protect:(e,t,n,i)=>i});const C=T,D=Object.freeze({get policy(){return T},setPolicy(e){if(T!==C)throw d.error(1201);T=e},setAttribute(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)},setBooleanAttribute(e,t,n){n?e.setAttribute(t,""):e.removeAttribute(t)}}),k=`fast-${Math.random().toString(36).substring(2,8)}`,M=`${k}{`,$=`}${k}`,L=$.length;let A=0;const B=()=>`${k}-${++A}`,O=Object.freeze({interpolation:e=>`${M}${e}${$}`,attribute:e=>`${B()}="${M}${e}${$}"`,comment:e=>`\x3c!--${M}${e}${$}--\x3e`}),P=Object.freeze({parse(e,t){const n=e.split(M);if(1===n.length)return null;const i=[];for(let e=0,r=n.length;e<r;++e){const r=n[e],s=r.indexOf($);let o;if(-1===s)o=r;else{const e=r.substring(0,s);i.push(t[e]),o=r.substring(s+L)}""!==o&&i.push(o)}return i}});class R extends MutationObserver{constructor(e){super((function(e){this.callback.call(null,e.filter((e=>this.observedNodes.has(e.target))))})),this.callback=e,this.observedNodes=new Set}observe(e,t){this.observedNodes.add(e),super.observe(e,t)}unobserve(e){this.observedNodes.delete(e),this.observedNodes.size<1&&this.disconnect()}}Object.freeze({create(e){const t=[],n={};let i=null,r=!1;return{source:e,context:v.default,targets:n,get isBound(){return r},addBehaviorFactory(e,t){var n,i,r,s;const o=e;o.id=null!==(n=o.id)&&void 0!==n?n:B(),o.targetNodeId=null!==(i=o.targetNodeId)&&void 0!==i?i:B(),o.targetTagName=null!==(r=t.tagName)&&void 0!==r?r:null,o.policy=null!==(s=o.policy)&&void 0!==s?s:D.policy,this.addTarget(o.targetNodeId,t),this.addBehavior(o.createBehavior())},addTarget(e,t){n[e]=t},addBehavior(e){t.push(e),r&&e.bind(this)},onUnbind(e){null===i&&(i=[]),i.push(e)},connectedCallback(e){r||(r=!0,t.forEach((e=>e.bind(this))))},disconnectedCallback(e){r&&(r=!1,null!==i&&i.forEach((e=>e.unbind(this))))}}}});const N="boolean",I="reflect",z=Object.freeze({locate:c()}),_={toView:e=>e?"true":"false",fromView:e=>!(null==e||"false"===e||!1===e||0===e)};function H(e){if(null==e)return null;const t=1*e;return isNaN(t)?null:t}const F={toView(e){const t=H(e);return t?t.toString():t},fromView:H};class V{constructor(e,t,n=t.toLowerCase(),i=I,r){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=n,this.mode=i,this.converter=r,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,i===N&&void 0===r&&(this.converter=_)}setValue(e,t){const n=e[this.fieldName],i=this.converter;void 0!==i&&(t=i.fromView(t)),n!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](n,t),e.$fastController.notify(this.name))}getValue(e){return f.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){const t=this.mode,n=this.guards;n.has(e)||"fromView"===t||p.enqueue((()=>{n.add(e);const i=e[this.fieldName];switch(t){case I:const t=this.converter;D.setAttribute(e,this.attribute,void 0!==t?t.toView(i):i);break;case N:D.setBooleanAttribute(e,this.attribute,i)}n.delete(e)}))}static collect(e,...t){const n=[];t.push(z.locate(e));for(let i=0,s=t.length;i<s;++i){const s=t[i];if(void 0!==s)for(let t=0,i=s.length;t<i;++t){const i=s[t];r(i)?n.push(new V(e,i)):n.push(new V(e,i.property,i.attribute,i.mode,i.converter))}}return n}}function j(e,t){let n;function i(e,t){arguments.length>1&&(n.property=t),z.locate(e.constructor).push(n)}return arguments.length>1?(n={},void i(e,t)):(n=void 0===e?{}:e,i)}const G={mode:"open"},W={},X=new Set,U=d.getById(n.elementRegistry,(()=>h()));class Y{constructor(e,t=e.definition){var n;this.platformDefined=!1,r(t)&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template,this.registry=null!==(n=t.registry)&&void 0!==n?n:customElements;const i=e.prototype,s=V.collect(e,t.attributes),o=new Array(s.length),a={},l={};for(let e=0,t=s.length;e<t;++e){const t=s[e];o[e]=t.attribute,a[t.name]=t,l[t.attribute]=t,f.defineProperty(i,t)}Reflect.defineProperty(e,"observedAttributes",{value:o,enumerable:!0}),this.attributes=s,this.propertyLookup=a,this.attributeLookup=l,this.shadowOptions=void 0===t.shadowOptions?G:null===t.shadowOptions?void 0:Object.assign(Object.assign({},G),t.shadowOptions),this.elementOptions=void 0===t.elementOptions?W:Object.assign(Object.assign({},W),t.elementOptions),this.styles=w.normalize(t.styles),U.register(this)}get isDefined(){return this.platformDefined}define(e=this.registry){const t=this.type;return e.get(this.name)||(this.platformDefined=!0,e.define(this.name,t,this.elementOptions)),this}static compose(e,t){return X.has(e)||U.getByType(e)?new Y(class extends e{},t):new Y(e,t)}static registerBaseType(e){X.add(e)}}Y.getByType=U.getByType,Y.getForInstance=U.getForInstance,f.defineProperty(Y.prototype,"template");const q=/fe-b\$\$start\$\$(\d+)\$\$(.+)\$\$fe-b/,K=/fe-b\$\$end\$\$(\d+)\$\$(.+)\$\$fe-b/,Q=/fe-repeat\$\$start\$\$(\d+)\$\$fe-repeat/,Z=/fe-repeat\$\$end\$\$(\d+)\$\$fe-repeat/,J=/^(?:.{0,1000})fe-eb\$\$start\$\$(.+?)\$\$fe-eb/,ee=/fe-eb\$\$end\$\$(.{0,1000})\$\$fe-eb(?:.{0,1000})$/;function te(e){return e&&e.nodeType===Node.COMMENT_NODE}const ne=Object.freeze({attributeMarkerName:"data-fe-b",attributeBindingSeparator:" ",contentBindingStartMarker:(e,t)=>`fe-b$$start$$${e}$$${t}$$fe-b`,contentBindingEndMarker:(e,t)=>`fe-b$$end$$${e}$$${t}$$fe-b`,repeatStartMarker:e=>`fe-repeat$$start$$${e}$$fe-repeat`,repeatEndMarker:e=>`fe-repeat$$end$$${e}$$fe-repeat`,isContentBindingStartMarker:e=>q.test(e),isContentBindingEndMarker:e=>K.test(e),isRepeatViewStartMarker:e=>Q.test(e),isRepeatViewEndMarker:e=>Z.test(e),isElementBoundaryStartMarker:e=>te(e)&&J.test(e.data.trim()),isElementBoundaryEndMarker:e=>te(e)&&ee.test(e.data),parseAttributeBinding(e){const t=e.getAttribute(this.attributeMarkerName);return null===t?t:t.split(this.attributeBindingSeparator).map((e=>parseInt(e)))},parseContentBindingStartMarker:e=>se(q,e),parseContentBindingEndMarker:e=>se(K,e),parseRepeatStartMarker:e=>ie(Q,e),parseRepeatEndMarker:e=>ie(Z,e),parseElementBoundaryStartMarker:e=>re(J,e.trim()),parseElementBoundaryEndMarker:e=>re(ee,e)});function ie(e,t){const n=e.exec(t);return null===n?n:parseInt(n[1])}function re(e,t){const n=e.exec(t);return null===n?n:n[1]}function se(e,t){const n=e.exec(t);return null===n?n:[parseInt(n[1]),n[2]]}const oe=Symbol.for("fe-hydration");function ae(e){return e[oe]===oe}const le={bubbles:!0,composed:!0,cancelable:!0},de="isConnected",he=new WeakMap;function ce(e){var t,n;return null!==(n=null!==(t=e.shadowRoot)&&void 0!==t?t:he.get(e))&&void 0!==n?n:null}let ue;class pe extends a{constructor(e,t){super(e),this.boundObservables=null,this.needsInitialization=!0,this.hasExistingShadowRoot=!1,this._template=null,this.stage=3,this.guardBehaviorConnection=!1,this.behaviors=null,this.behaviorsConnected=!1,this._mainStyles=null,this.$fastController=this,this.view=null,this.source=e,this.definition=t;const n=t.shadowOptions;if(void 0!==n){let t=e.shadowRoot;t?this.hasExistingShadowRoot=!0:(t=e.attachShadow(n),"closed"===n.mode&&he.set(e,t))}const i=f.getAccessors(e);if(i.length>0){const t=this.boundObservables=Object.create(null);for(let n=0,r=i.length;n<r;++n){const r=i[n].name,s=e[r];void 0!==s&&(delete e[r],t[r]=s)}}}get isConnected(){return f.track(this,de),1===this.stage}get context(){var e,t;return null!==(t=null===(e=this.view)||void 0===e?void 0:e.context)&&void 0!==t?t:v.default}get isBound(){var e,t;return null!==(t=null===(e=this.view)||void 0===e?void 0:e.isBound)&&void 0!==t&&t}get sourceLifetime(){var e;return null===(e=this.view)||void 0===e?void 0:e.sourceLifetime}get template(){var e;if(null===this._template){const t=this.definition;this.source.resolveTemplate?this._template=this.source.resolveTemplate():t.template&&(this._template=null!==(e=t.template)&&void 0!==e?e:null)}return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get mainStyles(){var e;if(null===this._mainStyles){const t=this.definition;this.source.resolveStyles?this._mainStyles=this.source.resolveStyles():t.styles&&(this._mainStyles=null!==(e=t.styles)&&void 0!==e?e:null)}return this._mainStyles}set mainStyles(e){this._mainStyles!==e&&(null!==this._mainStyles&&this.removeStyles(this._mainStyles),this._mainStyles=e,this.needsInitialization||this.addStyles(e))}onUnbind(e){var t;null===(t=this.view)||void 0===t||t.onUnbind(e)}addBehavior(e){var t,n;const i=null!==(t=this.behaviors)&&void 0!==t?t:this.behaviors=new Map,r=null!==(n=i.get(e))&&void 0!==n?n:0;0===r?(i.set(e,1),e.addedCallback&&e.addedCallback(this),!e.connectedCallback||this.guardBehaviorConnection||1!==this.stage&&0!==this.stage||e.connectedCallback(this)):i.set(e,r+1)}removeBehavior(e,t=!1){const n=this.behaviors;if(null===n)return;const i=n.get(e);void 0!==i&&(1===i||t?(n.delete(e),e.disconnectedCallback&&3!==this.stage&&e.disconnectedCallback(this),e.removedCallback&&e.removedCallback(this)):n.set(e,i-1))}addStyles(e){var t;if(!e)return;const n=this.source;if(e instanceof HTMLElement)(null!==(t=ce(n))&&void 0!==t?t:this.source).append(e);else if(!e.isAttachedTo(n)){const t=e.behaviors;if(e.addStylesTo(n),null!==t)for(let e=0,n=t.length;e<n;++e)this.addBehavior(t[e])}}removeStyles(e){var t;if(!e)return;const n=this.source;if(e instanceof HTMLElement)(null!==(t=ce(n))&&void 0!==t?t:n).removeChild(e);else if(e.isAttachedTo(n)){const t=e.behaviors;if(e.removeStylesFrom(n),null!==t)for(let e=0,n=t.length;e<n;++e)this.removeBehavior(t[e])}}connect(){3===this.stage&&(this.stage=0,this.bindObservables(),this.connectBehaviors(),this.needsInitialization?(this.renderTemplate(this.template),this.addStyles(this.mainStyles),this.needsInitialization=!1):null!==this.view&&this.view.bind(this.source),this.stage=1,f.notify(this,de))}bindObservables(){if(null!==this.boundObservables){const e=this.source,t=this.boundObservables,n=Object.keys(t);for(let i=0,r=n.length;i<r;++i){const r=n[i];e[r]=t[r]}this.boundObservables=null}}connectBehaviors(){if(!1===this.behaviorsConnected){const e=this.behaviors;if(null!==e){this.guardBehaviorConnection=!0;for(const t of e.keys())t.connectedCallback&&t.connectedCallback(this);this.guardBehaviorConnection=!1}this.behaviorsConnected=!0}}disconnectBehaviors(){if(!0===this.behaviorsConnected){const e=this.behaviors;if(null!==e)for(const t of e.keys())t.disconnectedCallback&&t.disconnectedCallback(this);this.behaviorsConnected=!1}}disconnect(){1===this.stage&&(this.stage=2,f.notify(this,de),null!==this.view&&this.view.unbind(),this.disconnectBehaviors(),this.stage=3)}onAttributeChangedCallback(e,t,n){const i=this.definition.attributeLookup[e];void 0!==i&&i.onAttributeChangedCallback(this.source,n)}emit(e,t,n){return 1===this.stage&&this.source.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},le),n)))}renderTemplate(e){var t;const n=this.source,i=null!==(t=ce(n))&&void 0!==t?t:n;if(null!==this.view)this.view.dispose(),this.view=null;else if(!this.needsInitialization||this.hasExistingShadowRoot){this.hasExistingShadowRoot=!1;for(let e=i.firstChild;null!==e;e=i.firstChild)i.removeChild(e)}e&&(this.view=e.render(n,i,n),this.view.sourceLifetime=g.coupled)}static forCustomElement(e,t=!1){const n=e.$fastController;if(void 0!==n&&!t)return n;const i=Y.getForInstance(e);if(void 0===i)throw d.error(1401);return f.getNotifier(i).subscribe({handleChange:()=>{pe.forCustomElement(e,!0),e.$fastController.connect()}},"template"),e.$fastController=new ue(e,i)}static setStrategy(e){ue=e}}function ge(e){var t;return"adoptedStyleSheets"in e?e:null!==(t=ce(e))&&void 0!==t?t:e.getRootNode()}u(pe),pe.setStrategy(pe);class fe{constructor(e){const t=fe.styleSheetCache;this.sheets=e.map((e=>{if(e instanceof CSSStyleSheet)return e;let n=t.get(e);return void 0===n&&(n=new CSSStyleSheet,n.replaceSync(e),t.set(e,n)),n}))}addStylesTo(e){be(ge(e),this.sheets)}removeStylesFrom(e){ye(ge(e),this.sheets)}}fe.styleSheetCache=new Map;let me=0;function ve(e){return e===document?document.body:e}let be=(e,t)=>{e.adoptedStyleSheets=[...e.adoptedStyleSheets,...t]},ye=(e,t)=>{e.adoptedStyleSheets=e.adoptedStyleSheets.filter((e=>-1===t.indexOf(e)))};if(w.supportsAdoptedStyleSheets){try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),be=(e,t)=>{e.adoptedStyleSheets.push(...t)},ye=(e,t)=>{for(const n of t){const t=e.adoptedStyleSheets.indexOf(n);-1!==t&&e.adoptedStyleSheets.splice(t,1)}}}catch(e){}w.setDefaultStrategy(fe)}else w.setDefaultStrategy(class{constructor(e){this.styles=e,this.styleClass="fast-"+ ++me}addStylesTo(e){e=ve(ge(e));const t=this.styles,n=this.styleClass;for(let i=0;i<t.length;i++){const r=document.createElement("style");r.innerHTML=t[i],r.className=n,e.append(r)}}removeStylesFrom(e){const t=(e=ve(ge(e))).querySelectorAll(`.${this.styleClass}`);for(let n=0,i=t.length;n<i;++n)e.removeChild(t[n])}});const we="defer-hydration",Ee="needs-hydration";class Se extends pe{static hydrationObserverHandler(e){for(const t of e)Se.hydrationObserver.unobserve(t.target),t.target.$fastController.connect()}connect(){var e,t;if(void 0===this.needsHydration&&(this.needsHydration=null!==this.source.getAttribute(Ee)),this.source.hasAttribute(we))return void Se.hydrationObserver.observe(this.source,{attributeFilter:[we]});if(!this.needsHydration)return void super.connect();if(3!==this.stage)return;this.stage=0,this.bindObservables(),this.connectBehaviors();const n=this.source,i=null!==(e=ce(n))&&void 0!==e?e:n;if(this.template)if(ae(this.template)){let e=i.firstChild,r=i.lastChild;null===n.shadowRoot&&(ne.isElementBoundaryStartMarker(e)&&(e.data="",e=e.nextSibling),ne.isElementBoundaryEndMarker(r)&&(r.data="",r=r.previousSibling)),this.view=this.template.hydrate(e,r,n),null===(t=this.view)||void 0===t||t.bind(this.source)}else this.renderTemplate(this.template);this.addStyles(this.mainStyles),this.stage=1,this.source.removeAttribute(Ee),this.needsInitialization=this.needsHydration=!1,f.notify(this,de)}disconnect(){super.disconnect(),Se.hydrationObserver.unobserve(this.source)}static install(){pe.setStrategy(Se)}}function xe(e){const t=class extends e{constructor(){super(),pe.forCustomElement(this)}$emit(e,t,n){return this.$fastController.emit(e,t,n)}connectedCallback(){this.$fastController.connect()}disconnectedCallback(){this.$fastController.disconnect()}attributeChangedCallback(e,t,n){this.$fastController.onAttributeChangedCallback(e,t,n)}};return Y.registerBaseType(t),t}function Te(e,t){return i(e)?Y.compose(e,t).define().type:Y.compose(this,e).define().type}Se.hydrationObserver=new R(Se.hydrationObserverHandler);const Ce=Object.assign(xe(HTMLElement),{from:function(e){return xe(e)},define:Te,compose:function(e,t){return i(e)?Y.compose(e,t):Y.compose(this,e)}});function De(e){return function(t){Te(t,e)}}class ke{constructor(e,t,n=!1){this.evaluate=e,this.policy=t,this.isVolatile=n}}class Me extends ke{createObserver(e){return f.binding(this.evaluate,e,this.isVolatile)}}function $e(e,t,n=f.isVolatileBinding(e)){return new Me(e,t,n)}class Le extends ke{createObserver(){return this}bind(e){return this.evaluate(e.source,e.context)}}function Ae(e,t){return new Le(e,t)}u(Le);const Be=h(),Oe=Object.freeze({getForInstance:Be.getForInstance,getByType:Be.getByType,define:(e,t)=>((t=t||{}).type=e,Be.register(t),e),assignAspect(e,t){if(t)switch(e.sourceAspect=t,t[0]){case":":e.targetAspect=t.substring(1),e.aspectType="classList"===e.targetAspect?E.tokenList:E.property;break;case"?":e.targetAspect=t.substring(1),e.aspectType=E.booleanAttribute;break;case"@":e.targetAspect=t.substring(1),e.aspectType=E.event;break;default:e.targetAspect=t,e.aspectType=E.attribute}else e.aspectType=E.content}});class Pe{constructor(e){this.options=e}createHTML(e){return O.attribute(e(this))}createBehavior(){return this}}u(Pe);class Re extends Error{constructor(e,t,n){super(e),this.factories=t,this.node=n}}function Ne(e){return e.nodeType===Node.COMMENT_NODE}function Ie(e){return e.nodeType===Node.TEXT_NODE}function ze(e,t){const n=document.createRange();return n.setStart(e,0),n.setEnd(t,Ne(t)||Ie(t)?t.data.length:t.childNodes.length),n}function _e(e,t,n){const i=ne.parseAttributeBinding(e);if(null!==i){for(const r of i){if(!t[r])throw new Re(`HydrationView was unable to successfully target factory on ${e.nodeName} inside ${e.getRootNode().host.nodeName}. This likely indicates a template mismatch between SSR rendering and hydration.`,t,e);Fe(t[r],e,n)}e.removeAttribute(ne.attributeMarkerName)}}function He(e,t,n,i,r){if(ne.isElementBoundaryStartMarker(e))!function(e,t){const n=ne.parseElementBoundaryStartMarker(e.data);let i=t.nextSibling();for(;null!==i;){if(Ne(i)){const e=ne.parseElementBoundaryEndMarker(i.data);if(e&&e===n)break}i=t.nextSibling()}}(e,t);else if(ne.isContentBindingStartMarker(e.data)){const s=ne.parseContentBindingStartMarker(e.data);if(null===s)return;const[o,a]=s,l=n[o],d=[];let h=t.nextSibling();e.data="";const c=h;for(;null!==h;){if(Ne(h)){const e=ne.parseContentBindingEndMarker(h.data);if(e&&e[1]===a)break}d.push(h),h=t.nextSibling()}if(null===h){const t=e.getRootNode();throw new Error(`Error hydrating Comment node inside "${function(e){return e instanceof DocumentFragment&&"mode"in e}(t)?t.host.nodeName:t.nodeName}".`)}h.data="",1===d.length&&Ie(d[0])?Fe(l,d[0],i):(h!==c&&null!==h.previousSibling&&(r[l.targetNodeId]={first:c,last:h.previousSibling}),Fe(l,h.parentNode.insertBefore(document.createTextNode(""),h),i))}}function Fe(e,t,n){if(void 0===e.targetNodeId)throw new Error("Factory could not be target to the node");n[e.targetNodeId]=t}var Ve;function je(e,t){const n=e.parentNode;let i,r=e;for(;r!==t;){if(i=r.nextSibling,!i)throw new Error(`Unmatched first/last child inside "${t.getRootNode().host.nodeName}".`);n.removeChild(r),r=i}n.removeChild(t)}class Ge{constructor(){this.index=0,this.length=0}get event(){return v.getEvent()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}eventDetail(){return this.event.detail}eventTarget(){return this.event.target}}class We extends Ge{constructor(e,t,n){super(),this.fragment=e,this.factories=t,this.targets=n,this.behaviors=null,this.unbindables=[],this.source=null,this.isBound=!1,this.sourceLifetime=g.unknown,this.context=this,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{const t=this.lastChild;if(e.previousSibling===t)return;const n=e.parentNode;let i,r=this.firstChild;for(;r!==t;)i=r.nextSibling,n.insertBefore(r,e),r=i;n.insertBefore(t,e)}}remove(){const e=this.fragment,t=this.lastChild;let n,i=this.firstChild;for(;i!==t;)n=i.nextSibling,e.appendChild(i),i=n;e.appendChild(t)}dispose(){je(this.firstChild,this.lastChild),this.unbind()}onUnbind(e){this.unbindables.push(e)}bind(e,t=this){if(this.source===e)return;let n=this.behaviors;if(null===n){this.source=e,this.context=t,this.behaviors=n=new Array(this.factories.length);const i=this.factories;for(let e=0,t=i.length;e<t;++e){const t=i[e].createBehavior();t.bind(this),n[e]=t}}else{null!==this.source&&this.evaluateUnbindables(),this.isBound=!1,this.source=e,this.context=t;for(let e=0,t=n.length;e<t;++e)n[e].bind(this)}this.isBound=!0}unbind(){this.isBound&&null!==this.source&&(this.evaluateUnbindables(),this.source=null,this.context=this,this.isBound=!1)}evaluateUnbindables(){const e=this.unbindables;for(let t=0,n=e.length;t<n;++t)e[t].unbind(this);e.length=0}static disposeContiguousBatch(e){if(0!==e.length){je(e[0].firstChild,e[e.length-1].lastChild);for(let t=0,n=e.length;t<n;++t)e[t].unbind()}}}u(We),f.defineProperty(We.prototype,"index"),f.defineProperty(We.prototype,"length");const Xe="hydrated";class Ue extends Error{constructor(e,t,n,i){super(e),this.factory=t,this.fragment=n,this.templateString=i}}Ve=oe,u(class extends Ge{constructor(e,t,n,i){super(),this.firstChild=e,this.lastChild=t,this.sourceTemplate=n,this.hostBindingTarget=i,this[Ve]=oe,this.context=this,this.source=null,this.isBound=!1,this.sourceLifetime=g.unknown,this.unbindables=[],this.fragment=null,this.behaviors=null,this._hydrationStage="unhydrated",this._bindingViewBoundaries={},this._targets={},this.factories=n.compile().factories}get hydrationStage(){return this._hydrationStage}get targets(){return this._targets}get bindingViewBoundaries(){return this._bindingViewBoundaries}insertBefore(e){if(null!==this.fragment)if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{const t=this.lastChild;if(e.previousSibling===t)return;const n=e.parentNode;let i,r=this.firstChild;for(;r!==t;)i=r.nextSibling,n.insertBefore(r,e),r=i;n.insertBefore(t,e)}}appendTo(e){null!==this.fragment&&e.appendChild(this.fragment)}remove(){const e=this.fragment||(this.fragment=document.createDocumentFragment()),t=this.lastChild;let n,i=this.firstChild;for(;i!==t;){if(n=i.nextSibling,!n)throw new Error(`Unmatched first/last child inside "${t.getRootNode().host.nodeName}".`);e.appendChild(i),i=n}e.appendChild(t)}bind(e,t=this){var n,i;if(this.hydrationStage!==Xe&&(this._hydrationStage="hydrating"),this.source===e)return;let r=this.behaviors;if(null===r){this.source=e,this.context=t;try{const{targets:e,boundaries:t}=function(e,t,n){const i=ze(e,t),r=i.commonAncestorContainer,s=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_COMMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>0===i.comparePoint(e,0)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),o={},a={};let l=s.currentNode=e;for(;null!==l;){switch(l.nodeType){case Node.ELEMENT_NODE:_e(l,n,o);break;case Node.COMMENT_NODE:He(l,s,n,o,a)}l=s.nextNode()}return i.detach(),{targets:o,boundaries:a}}(this.firstChild,this.lastChild,this.factories);this._targets=e,this._bindingViewBoundaries=t}catch(e){if(e instanceof Re){let t=this.sourceTemplate.html;"string"!=typeof t&&(t=t.innerHTML),e.templateString=t}throw e}this.behaviors=r=new Array(this.factories.length);const s=this.factories;for(let e=0,t=s.length;e<t;++e){const t=s[e];if("h"===t.targetNodeId&&this.hostBindingTarget&&Fe(t,this.hostBindingTarget,this._targets),!(t.targetNodeId in this.targets)){let e=this.sourceTemplate.html;throw"string"!=typeof e&&(e=e.innerHTML),new Ue(`HydrationView was unable to successfully target bindings inside "${null===(i=(null===(n=this.firstChild)||void 0===n?void 0:n.getRootNode()).host)||void 0===i?void 0:i.nodeName}".`,t,ze(this.firstChild,this.lastChild).cloneContents(),e)}{const n=t.createBehavior();n.bind(this),r[e]=n}}}else{null!==this.source&&this.evaluateUnbindables(),this.isBound=!1,this.source=e,this.context=t;for(let e=0,t=r.length;e<t;++e)r[e].bind(this)}this.isBound=!0,this._hydrationStage=Xe}unbind(){this.isBound&&null!==this.source&&(this.evaluateUnbindables(),this.source=null,this.context=this,this.isBound=!1)}dispose(){je(this.firstChild,this.lastChild),this.unbind()}onUnbind(e){this.unbindables.push(e)}evaluateUnbindables(){const e=this.unbindables;for(let t=0,n=e.length;t<n;++t)e[t].unbind(this);e.length=0}});const Ye={[E.attribute]:D.setAttribute,[E.booleanAttribute]:D.setBooleanAttribute,[E.property]:(e,t,n)=>e[t]=n,[E.content]:function(e,t,n,i){if(null==n&&(n=""),function(e){return void 0!==e.create}(n)){e.textContent="";let t=e.$fastView;if(void 0===t)if(ae(i)&&ae(n)&&void 0!==i.bindingViewBoundaries[this.targetNodeId]&&i.hydrationStage!==Xe){const e=i.bindingViewBoundaries[this.targetNodeId];t=n.hydrate(e.first,e.last)}else t=n.create();else e.$fastTemplate!==n&&(t.isComposed&&(t.remove(),t.unbind()),t=n.create());t.isComposed?t.needsBindOnly&&(t.needsBindOnly=!1,t.bind(i.source,i.context)):(t.isComposed=!0,t.bind(i.source,i.context),t.insertBefore(e),e.$fastView=t,e.$fastTemplate=n)}else{const t=e.$fastView;void 0!==t&&t.isComposed&&(t.isComposed=!1,t.remove(),t.needsBindOnly?t.needsBindOnly=!1:t.unbind()),e.textContent=n}},[E.tokenList]:function(e,t,n){var i;const r=`${this.id}-t`,s=null!==(i=e[r])&&void 0!==i?i:e[r]={v:0,cv:Object.create(null)},o=s.cv;let a=s.v;const l=e[t];if(null!=n&&n.length){const e=n.split(/\s+/);for(let t=0,n=e.length;t<n;++t){const n=e[t];""!==n&&(o[n]=a,l.add(n))}}if(s.v=a+1,0!==a){a-=1;for(const e in o)o[e]===a&&l.remove(e)}},[E.event]:()=>{}};class qe{constructor(e){this.dataBinding=e,this.updateTarget=null,this.aspectType=E.content}createHTML(e){return O.interpolation(e(this))}createBehavior(){var e;if(null===this.updateTarget){const t=Ye[this.aspectType],n=null!==(e=this.dataBinding.policy)&&void 0!==e?e:this.policy;if(!t)throw d.error(1205);this.data=`${this.id}-d`,this.updateTarget=n.protect(this.targetTagName,this.aspectType,this.targetAspect,t)}return this}bind(e){var t;const n=e.targets[this.targetNodeId],i=ae(e)&&e.hydrationStage&&e.hydrationStage!==Xe;switch(this.aspectType){case E.event:n[this.data]=e,n.addEventListener(this.targetAspect,this,this.dataBinding.options);break;case E.content:e.onUnbind(this);default:const r=null!==(t=n[this.data])&&void 0!==t?t:n[this.data]=this.dataBinding.createObserver(this,this);if(r.target=n,r.controller=e,i&&(this.aspectType===E.attribute||this.aspectType===E.booleanAttribute)){r.bind(e);break}this.updateTarget(n,this.targetAspect,r.bind(e),e)}}unbind(e){const t=e.targets[this.targetNodeId].$fastView;void 0!==t&&t.isComposed&&(t.unbind(),t.needsBindOnly=!0)}handleEvent(e){const t=e.currentTarget[this.data];if(t.isBound){v.setEvent(e);const n=this.dataBinding.evaluate(t.source,t.context);v.setEvent(null),!0!==n&&e.preventDefault()}}handleChange(e,t){const n=t.target,i=t.controller;this.updateTarget(n,this.targetAspect,t.bind(i),i)}}Oe.define(qe,{aspected:!0});const Ke=(e,t)=>`${e}.${t}`,Qe={},Ze={index:0,node:null};function Je(e){e.startsWith("fast-")||d.warn(1204,{name:e})}const et=new Proxy(document.createElement("div"),{get(e,t){Je(t);const n=Reflect.get(e,t);return i(n)?n.bind(e):n},set:(e,t,n)=>(Je(t),Reflect.set(e,t,n))});class tt{constructor(e,t,n){this.fragment=e,this.directives=t,this.policy=n,this.proto=null,this.nodeIds=new Set,this.descriptors={},this.factories=[]}addFactory(e,t,n,i,r){var s,o;this.nodeIds.has(n)||(this.nodeIds.add(n),this.addTargetDescriptor(t,n,i)),e.id=null!==(s=e.id)&&void 0!==s?s:B(),e.targetNodeId=n,e.targetTagName=r,e.policy=null!==(o=e.policy)&&void 0!==o?o:this.policy,this.factories.push(e)}freeze(){return this.proto=Object.create(null,this.descriptors),this}addTargetDescriptor(e,t,n){const i=this.descriptors;if("r"===t||"h"===t||i[t])return;if(!i[e]){const t=e.lastIndexOf("."),n=e.substring(0,t),i=parseInt(e.substring(t+1));this.addTargetDescriptor(n,e,i)}let r=Qe[t];if(!r){const i=`_${t}`;Qe[t]=r={get(){var t;return null!==(t=this[i])&&void 0!==t?t:this[i]=this[e].childNodes[n]}}}i[t]=r}createView(e){const t=this.fragment.cloneNode(!0),n=Object.create(this.proto);n.r=t,n.h=null!=e?e:et;for(const e of this.nodeIds)n[e];return new We(t,this.factories,n)}}function nt(e,t,n,i,r,s=!1){const o=n.attributes,a=e.directives;for(let l=0,d=o.length;l<d;++l){const h=o[l],c=h.value,u=P.parse(c,a);let p=null;null===u?s&&(p=new qe(Ae((()=>c),e.policy)),Oe.assignAspect(p,h.name)):p=ot.aggregate(u,e.policy),null!==p&&(n.removeAttributeNode(h),l--,d--,e.addFactory(p,t,i,r,n.tagName))}}function it(e,t,n){let i=0,r=t.firstChild;for(;r;){const t=rt(e,n,r,i);r=t.node,i=t.index}}function rt(e,t,n,i){const s=Ke(t,i);switch(n.nodeType){case 1:nt(e,t,n,s,i),it(e,n,s);break;case 3:return function(e,t,n,i,s){const o=P.parse(t.textContent,e.directives);if(null===o)return Ze.node=t.nextSibling,Ze.index=s+1,Ze;let a,l=a=t;for(let t=0,d=o.length;t<d;++t){const d=o[t];0!==t&&(s++,i=Ke(n,s),a=l.parentNode.insertBefore(document.createTextNode(""),l.nextSibling)),r(d)?a.textContent=d:(a.textContent=" ",Oe.assignAspect(d),e.addFactory(d,n,i,s,null)),l=a}return Ze.index=s+1,Ze.node=l.nextSibling,Ze}(e,n,t,s,i);case 8:const o=P.parse(n.data,e.directives);null!==o&&e.addFactory(ot.aggregate(o),t,s,i,null)}return Ze.index=i+1,Ze.node=n.nextSibling,Ze}const st="TEMPLATE",ot={compile(e,t,n=D.policy){let i;if(r(e)){i=document.createElement(st),i.innerHTML=n.createHTML(e);const t=i.content.firstElementChild;null!==t&&t.tagName===st&&(i=t)}else i=e;i.content.firstChild||i.content.lastChild||i.content.appendChild(document.createComment(""));const s=document.adoptNode(i.content),o=new tt(s,t,n);var a,l;return nt(o,"",i,"h",0,!0),l=t,((a=s.firstChild)&&8==a.nodeType&&null!==P.parse(a.data,l)||1===s.childNodes.length&&Object.keys(t).length>0)&&s.insertBefore(document.createComment(""),s.firstChild),it(o,s,"r"),Ze.node=null,o.freeze()},setDefaultStrategy(e){this.compile=e},aggregate(e,t=D.policy){if(1===e.length)return e[0];let n,i,s=!1;const o=e.length,a=e.map((e=>r(e)?()=>e:(n=e.sourceAspect||n,s=s||e.dataBinding.isVolatile,i=i||e.dataBinding.policy,e.dataBinding.evaluate))),l=new qe($e(((e,t)=>{let n="";for(let i=0;i<o;++i)n+=a[i](e,t);return n}),null!=i?i:t,s));return Oe.assignAspect(l,n),l}},at=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,lt=Object.create(null);class dt{constructor(e,t=lt){this.html=e,this.factories=t}createHTML(e){const t=this.factories;for(const n in t)e(t[n]);return this.html}}function ht(e,t,n,i=Oe.getForInstance(e)){if(i.aspected){const n=at.exec(t);null!==n&&Oe.assignAspect(e,n[2])}return e.createHTML(n)}dt.empty=new dt(""),Oe.define(dt);class ct{constructor(e,t={},n){this.policy=n,this.result=null,this.html=e,this.factories=t}compile(){return null===this.result&&(this.result=ot.compile(this.html,this.factories,this.policy)),this.result}create(e){return this.compile().createView(e)}inline(){return new dt(r(this.html)?this.html:this.html.innerHTML,this.factories)}withPolicy(e){if(this.result)throw d.error(1208);if(this.policy)throw d.error(1207);return this.policy=e,this}render(e,t,n){const i=this.create(n);return i.bind(e),i.appendTo(t),i}static create(e,t,n){let r="";const s=Object.create(null),o=e=>{var t;const n=null!==(t=e.id)&&void 0!==t?t:e.id=B();return s[n]=e,n};for(let n=0,s=e.length-1;n<s;++n){const s=e[n];let a,l=t[n];if(r+=s,i(l))l=new qe($e(l));else if(l instanceof ke)l=new qe(l);else if(!(a=Oe.getForInstance(l))){const e=l;l=new qe(Ae((()=>e)))}r+=ht(l,s,o,a)}return new ct(r+e[e.length-1],s,n)}}u(ct);const ut=(e,...t)=>{if(Array.isArray(e)&&Array.isArray(e.raw))return ct.create(e,t);throw d.error(1206)};ut.partial=e=>new dt(e);class pt extends Pe{bind(e){e.source[this.options]=e.targets[this.targetNodeId]}}Oe.define(pt);const gt=e=>new pt(e),ft=h(),mt=Object.freeze({getForInstance:ft.getForInstance,getByType:ft.getByType,define:e=>(ft.register({type:e}),e)});function vt(e,t,n){t.source.style.setProperty(e.targetAspect,n.bind(t))}class bt{constructor(e,t){this.dataBinding=e,this.targetAspect=t}createCSS(e){return e(this),`var(${this.targetAspect})`}addedCallback(e){var t;const n=e.source;if(!n.$cssBindings){n.$cssBindings=new Map;const e=n.setAttribute;n.setAttribute=(t,i)=>{e.call(n,t,i),"style"===t&&n.$cssBindings.forEach(((e,t)=>vt(t,e.controller,e.observer)))}}const i=null!==(t=e[this.targetAspect])&&void 0!==t?t:e[this.targetAspect]=this.dataBinding.createObserver(this,this);i.controller=e,e.source.$cssBindings.set(this,{controller:e,observer:i})}connectedCallback(e){vt(this,e,e[this.targetAspect])}removedCallback(e){e.source.$cssBindings&&e.source.$cssBindings.delete(this)}handleChange(e,t){vt(this,t.controller,t)}}mt.define(bt);const yt=`${Math.random().toString(36).substring(2,8)}`;let wt=0;const Et=()=>`--v${yt}${++wt}`;function St(e,t){const n=[];let r="";const s=[],o=e=>{s.push(e)};for(let s=0,a=e.length-1;s<a;++s){r+=e[s];let a=t[s];i(a)?a=new bt($e(a),Et()).createCSS(o):a instanceof ke?a=new bt(a,Et()).createCSS(o):void 0!==mt.getForInstance(a)&&(a=a.createCSS(o)),a instanceof w||a instanceof CSSStyleSheet?(""!==r.trim()&&(n.push(r),r=""),n.push(a)):r+=a}return r+=e[e.length-1],""!==r.trim()&&n.push(r),{styles:n,behaviors:s}}const xt=(e,...t)=>{const{styles:n,behaviors:i}=St(e,t),r=new w(n);return i.length?r.withBehaviors(...i):r};class Tt{constructor(e,t){this.behaviors=t,this.css="";const n=e.reduce(((e,t)=>(r(t)?this.css+=t:e.push(t),e)),[]);n.length&&(this.styles=new w(n))}createCSS(e){return this.behaviors.forEach(e),this.styles&&e(this),this.css}addedCallback(e){e.addStyles(this.styles)}removedCallback(e){e.removeStyles(this.styles)}}mt.define(Tt),xt.partial=(e,...t)=>{const{styles:n,behaviors:i}=St(e,t);return new Tt(n,i)};var Ct=Object.defineProperty,Dt=Object.defineProperties,kt=(Object.getOwnPropertyDescriptor,Object.getOwnPropertyDescriptors),Mt=Object.getOwnPropertySymbols,$t=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable,At=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Bt=(e,t)=>{for(var n in t||(t={}))$t.call(t,n)&&At(e,n,t[n]);if(Mt)for(var n of Mt(t))Lt.call(t,n)&&At(e,n,t[n]);return e},Ot=(e=>(e[e.None=0]="None",e[e.Top=2]="Top",e[e.Right=4]="Right",e[e.Bottom=8]="Bottom",e[e.Left=16]="Left",e[e.Horizontal=20]="Horizontal",e[e.Vertical=10]="Vertical",e))(Ot||{});const Pt=ut`
<slot></slot>
<div id="slot-pointer-event-blocker"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle horizontal"     part="top"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle vertical"       part="right"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle horizontal"     part="bottom"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle vertical"       part="left"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle corner"         part="top left"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle corner"         part="top right"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle corner"         part="bottom left"></div>
<div tabindex="-1" @keydown="${(e,t)=>e.handle_keydown(t.event)}" @click="${(e,t)=>e.handle_dblclick(t.event)}" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}" class="handle corner"         part="bottom right"></div>
`,Rt=xt`
:host{
    position: relative;
    display: block;
    --handle-size: 8px;
    min-width: var(--handle-size);
    min-height: var(--handle-size);
    overflow: hidden;
    pointer-events: none;
}

#slot-pointer-event-blocker {
    position: absolute;
    width: 100%;
    height: 100%;
    top:0;
    left:0;
    
    pointer-events: none;
}

:host(:state(resizing)) #slot-pointer-event-blocker {
    pointer-events: all;
}

:host(:not(:has(*))) {
    width: 100%;
    height: 100%;
    
}

:host > * {
    pointer-events: auto;
}

[part] {
    position: absolute;
}

.handle {
    touch-action: none;
}
.handle:focus {
    outline: none;
}

:host div {
    display: none;
}
:host(:not(left):not(right):not(top):not(bottom)) div {
    display: block
}
:host([left])::part(left) {
    display: block;
}
:host([left][top])::part(top left) {
    display: block;
}
:host([left])::part(top) {
    display: block;
}
:host([right][top])::part(top right) {
    display: block;
}
:host([left])::part(right) {
    display: block;
}
:host([right][bottom])::part(bottom right) {
    display: block;
}
:host([bottom])::part(bottom) {
    display: block;
}
:host([left][bottom])::part(bottom left) {
    display: block;
}

.vertical {
    width: var(--handle-size);
    height: calc(100% - 2*var(--handle-size));
}

.horizontal {
    width: calc(100% - 2*var(--handle-size));
    height: var(--handle-size);
}

.corner {   
    width: var(--handle-size);
    height: var(--handle-size);
}

[part="top"]{
    cursor: row-resize;
    left: var(--handle-size);
    top: 0;
}
    
[part="right"]{
    cursor: col-resize;
    right: 0;
    top: var(--handle-size);
}
    
[part="bottom"]{
    cursor: row-resize;
    left: var(--handle-size);
    bottom: 0;
}

[part="left"]{
    cursor: col-resize;
    left: 0;
    top: var(--handle-size);
}

[part="top left"]{
    cursor: nw-resize;
    top: 0;
    left: 0;
}

[part="top right"]{
    cursor: ne-resize;
    top: 0;
    right: 0;
}

[part="bottom left"]{
    cursor: sw-resize;
    bottom: 0;
    left: 0;
}

[part="bottom right"]{
    cursor: se-resize;
    bottom: 0;
    right: 0;
}`;let Nt=class extends Ce{constructor(){super(),this.resizing=!1,this.originX=0,this.originY=0,this.deltaX=0,this.deltaY=0,this.widthAtStart=0,this.heightAtStart=0,this.resizeHandle=null,this.clickedAt=null,this.internals=this.attachInternals()}connectedCallback(){super.connectedCallback()}getDetail(e){const t=e.target;let n=this.deltaX,i=this.deltaY,r=0;return t&&(t.part.contains("left")&&(r|=16),t.part.contains("right")&&(r|=4),t.part.contains("top")&&(r|=2),t.part.contains("bottom")&&(r|=8)),20&r||(n=0),10&r||(i=0),{originX:this.originX,originY:this.originY,deltaX:n,deltaY:i,clientX:e.clientX,clientY:e.clientY,handle:r}}handle_onpointerdown(e){if(this.deltaX=0,this.deltaY=0,e.target){const t=e.target;t.onpointermove=this.handle_onpointermove.bind(this),t.setPointerCapture(e.pointerId),this.resizeHandle=t,this.originX=e.clientX,this.originY=e.clientY,this.internals.states.add("resizing"),this.widthAtStart=this.offsetWidth,this.heightAtStart=this.offsetHeight,t.focus(),this.resizing=!0;const n=new CustomEvent(Nt.EVENTS.resizestart,this.createResizeEvent(e,this.getDetail(e)));this.dispatchEvent(n),e.stopPropagation(),e.preventDefault()}}handle_onpointermove(e){if(this.resizing){this.deltaX+=e.movementX,this.deltaY+=e.movementY;const t=new CustomEvent(Nt.EVENTS.resizing,this.createResizeEvent(e,this.getDetail(e)));this.dispatchEvent(t),e.stopPropagation(),e.preventDefault()}}handle_onpointerup(e){if(e.target&&this.resizing){const t=e.target;t.onpointermove=null,this.resizing=!1;const n=new CustomEvent(Nt.EVENTS.resizeend,this.createResizeEvent(e,this.getDetail(e)));this.dispatchEvent(n),t.releasePointerCapture(e.pointerId),this.resizeHandle=null,this.internals.states.delete("resizing"),e.stopPropagation(),e.preventDefault()}}handle_onpointerleave(e){var t;if(this.resizing&&(e.target||this.resizeHandle)){const n=e.target||this.resizeHandle;n.onpointermove=null,this.resizing=!1;const i=new CustomEvent(Nt.EVENTS.resizecanceled,this.createResizeEvent(e,this.getDetail(e)));this.dispatchEvent(i),n.releasePointerCapture(e.pointerId),null==(t=this.resizeHandle)||t.releasePointerCapture(e.pointerId),this.resizeHandle=null,this.internals.states.delete("resizing"),e.stopPropagation(),e.preventDefault()}}handle_keydown(e){"Escape"==e.key&&this.cancelResize()}handle_dblclick(e){let t=e.detail>=2,n=new Date;if(t||null==this.clickedAt||(t=n.getTime()-this.clickedAt.getTime()<300),this.clickedAt=n,t&&e.target instanceof HTMLElement){const t=new CustomEvent(Nt.EVENTS.resetsize,this.createResizeEvent(e,this.getDetail(e)));this.dispatchEvent(t)}}cancelResize(){let e=new PointerEvent("pointercancel",{});this.handle_onpointerleave(e)}dispatchEvent(e){let t=super.dispatchEvent(e);return t&&!e.defaultPrevented&&(e.type==Nt.EVENTS.resizeend||e.type==Nt.EVENTS.resizing?this.defaultReizeHandler(e):e.type==Nt.EVENTS.resetsize?this.defaultResetSizeHandler(e):e.type==Nt.EVENTS.resizecanceled&&this.defaultResizeCancel(e)),t}defaultResizeCancel(e){""!=this.style.width&&(this.style.width=`${this.widthAtStart}px`),""!=this.style.height&&(this.style.height=`${this.heightAtStart}px`)}defaultResetSizeHandler(e){20&e.detail.handle&&(this.style.width=""),10&e.detail.handle&&(this.style.height="")}defaultReizeHandler(e){if(0!=e.detail.deltaX){let t=16&e.detail.handle?-e.detail.deltaX:e.detail.deltaX,n=Math.max(0,this.widthAtStart+t);this.style.width=`${n}px`}if(0!=e.detail.deltaY){let t=2&e.detail.handle?-e.detail.deltaY:e.detail.deltaY,n=Math.max(0,this.heightAtStart+t);this.style.height=`${n}px`}}createResizeEvent(e,t){return n=Bt({},e),i={bubbles:!0,composed:!0,cancelable:!0,detail:Bt({ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey},t)},Dt(n,kt(i));var n,i}};function It(e){let t=new DOMPoint(0,0),n=e.getAttribute("transform-origin");if(""!=n&&null!=n||(n=window.getComputedStyle(e).transformOrigin),""!=n&&null!=n){let e=n.split(" ").map((e=>parseInt(e)));t.x=e[0],t.y=e.length>1?e[1]:e[0]}return t}function zt(e){let t=e.x+e.width/2,n=e.y+e.height/2;return new DOMPoint(t,n)}function _t(e,t){let n=[new DOMPoint(t.x,t.y),new DOMPoint(t.x+t.width,t.y+t.height)];n=n.map((t=>t.matrixTransform(e)));let i=n[0].x,r=n[0].y,s=n[1].x-i,o=n[1].y-r;return new DOMRect(i,r,s,o)}function Ht(e){var t,n;let i=e.getBBox();if(e instanceof SVGSVGElement){let r=parseInt(null!=(t=e.getAttribute("x"))?t:"0"),s=parseInt(null!=(n=e.getAttribute("y"))?n:"0");r=Math.round(r),s=Math.round(s),i.x+=r,i.y+=s}return i}function Ft(e,t){let n=Ht(e),i=[new DOMPoint(n.x,n.y),new DOMPoint(n.x+n.width,n.y),new DOMPoint(n.x,n.y+n.height),new DOMPoint(n.x+n.width,n.y+n.height)],r=e.getCTM(),s=null==t?void 0:t.getCTM();if(r){let e=r;s&&(e=s.inverse().multiply(r)),i=i.map((t=>t.matrixTransform(e)))}let o=Math.min(...i.map((e=>e.x))),a=Math.min(...i.map((e=>e.y))),l=Math.max(...i.map((e=>e.x))),d=Math.max(...i.map((e=>e.y)));return new DOMRect(o,a,l-o,d-a)}function Vt(e){let t=e.closest("svg");return t==e&&e.parentElement instanceof SVGElement&&(t=e.parentElement.closest("svg")),t}function jt(e,t){let n=Vt(e),i=null;e.parentElement instanceof SVGGraphicsElement&&(i=e.parentElement.getCTM());let r=Ft(e,n);if(i){let e=i.inverse();r=_t(e,r),t=t.matrixTransform(e)}let s=t.x-r.x,o=t.y-r.y,a=new DOMMatrix;a=a.translateSelf(s,o),Wt(e,a)}function Gt(e,t){let n=Vt(e),i=null;e.parentElement instanceof SVGGraphicsElement&&(i=e.parentElement.getCTM());let r=Ft(e,n);0!=r.width&&0!=r.height||(e.setAttribute("x",t.x.toString()),e.setAttribute("y",t.y.toString()),e.setAttribute("width",t.width.toString()),e.setAttribute("height",t.height.toString()),r=t);let s=zt(r);if(i){let e=i.inverse();r=_t(e,r),t=_t(e,t),s=s.matrixTransform(e)}let o=t.width/r.width,a=t.height/r.height,l=zt(t),d=zt(r),h=l.x-d.x,c=l.y-d.y,u=It(e),p=new DOMMatrix;p=p.translateSelf(h,c).scale(o,a,1,s.x-u.x,s.y-u.y),Wt(e,p)}function Wt(e,t){let n=e.closest("svg").createSVGTransform();if(n){n.setMatrix(t);let i=e.transform.baseVal;i.insertItemBefore(n,0),i.consolidate(),e instanceof SVGForeignObjectElement&&Xt(e)}}function Xt(e,t=!1){let n=Ft(e,Vt(e));if(!t){let t=null;e.parentElement instanceof SVGGraphicsElement&&(t=e.parentElement.getCTM()),t&&(n=_t(t.inverse(),n))}e.setAttribute("x",n.x.toString()),e.setAttribute("y",n.y.toString()),e.setAttribute("width",n.width.toString()),e.setAttribute("height",n.height.toString()),e.removeAttribute("transform")}function Ut(e,t){if(t){const n=e%t;Math.abs(n)<t/2?e-=n:e+=n>0?t-n:-(t+n)}return e}Nt.EVENTS={resizestart:"resizestart",resizing:"resizing",resizeend:"resizeend",resizecanceled:"resizecanceled",resetsize:"resetsize"},Nt=((e,t)=>{for(var n,i=t,r=e.length-1;r>=0;r--)(n=e[r])&&(i=n(i)||i);return i})([De({name:"mmr-resize-handle",template:Pt,styles:Rt})],Nt);const Yt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let qt;const Kt=new Uint8Array(16),Qt=[];for(let e=0;e<256;++e)Qt.push((e+256).toString(16).slice(1));const Zt=function(e,t,n){var i,r,s;if(Yt.randomUUID&&!t&&!e)return Yt.randomUUID();const o=null!=(s=null!=(r=(e=e||{}).random)?r:null==(i=e.rng)?void 0:i.call(e))?s:function(){if(!qt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");qt=crypto.getRandomValues.bind(crypto)}return qt(Kt)}();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=o[e];return t}return function(e,t=0){return(Qt[e[t+0]]+Qt[e[t+1]]+Qt[e[t+2]]+Qt[e[t+3]]+"-"+Qt[e[t+4]]+Qt[e[t+5]]+"-"+Qt[e[t+6]]+Qt[e[t+7]]+"-"+Qt[e[t+8]]+Qt[e[t+9]]+"-"+Qt[e[t+10]]+Qt[e[t+11]]+Qt[e[t+12]]+Qt[e[t+13]]+Qt[e[t+14]]+Qt[e[t+15]]).toLowerCase()}(o)},Jt=/^(([^\/\\;]+)\/([^\/\\;]+))(;(.*))?$/i,en=/^([^=]+)=(.+)$/i;function tn(e){let t=Jt.exec(e);if(t){let e=t[5]?(n=t[5],Object.fromEntries(n.split(";").map((e=>{let t=en.exec(e);if(t)return[t[1],t[2]]})).filter((e=>null!=e)))):void 0;return{mimeType:t[1],type:t[2],subtype:t[3],parameters:e}}var n}class nn{constructor(e,t=!0){this.loaders=e,this.requiresIsTrusted=t}willParse(e,t){if(!e)return!1;if(!(null==t?void 0:t.isTrusted)&&this.requiresIsTrusted)return!1;for(let t of e.items)if(this.canParse(t))return!0;return!1}canParse(e){return this.canParseType(e.type)}canParseType(e){var t;return!!(null==(t=this.loaders)?void 0:t.some((t=>t.loader.canLoad(e))))}parse(e,t){return new rn(this.loaders,e,t.isTrusted)}}class rn{constructor(e,t,n){this.loaders=e,this.dataTransferIsTrusted=n,this.loaderIndex=0,this.itemIndex=0,this.items=[];for(let e of t.items){let t=tn(e.type);t&&this.items.push({item:e,mimeType:t})}}get done(){return this.loaderIndex>=this.loaders.length}getValue(){return e=this,t=function*(){for(;this.loaderIndex<this.loaders.length;this.loaderIndex++){let e=this.loaders[this.loaderIndex],t=e.loader;for(;this.itemIndex<this.items.length;this.itemIndex++){let n=this.items[this.itemIndex];if(t.canLoad(n.mimeType.mimeType)&&"both"==e.type||e.type==n.item.kind){let e=yield t.load(n.item,this.dataTransferIsTrusted);if(e)return{content:e,mimeType:n.mimeType,type:n.item.kind}}}this.itemIndex=0}},new Promise(((n,i)=>{var r=e=>{try{o(t.next(e))}catch(e){i(e)}},s=e=>{try{o(t.throw(e))}catch(e){i(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,s);o((t=t.apply(e,null)).next())}));var e,t}next(){return++this.itemIndex%this.items.length==0&&this.loaderIndex++,this}}let sn={};const on=new WeakMap,an={metric:[{from:0,to:1e3,unit:"B",long:"bytes"},{from:1e3,to:1e6,unit:"kB",long:"kilobytes"},{from:1e6,to:1e9,unit:"MB",long:"megabytes"},{from:1e9,to:1e12,unit:"GB",long:"gigabytes"},{from:1e12,to:1e15,unit:"TB",long:"terabytes"},{from:1e15,to:1e18,unit:"PB",long:"petabytes"},{from:1e18,to:1e21,unit:"EB",long:"exabytes"},{from:1e21,to:1e24,unit:"ZB",long:"zettabytes"},{from:1e24,to:1e27,unit:"YB",long:"yottabytes"}],metric_octet:[{from:0,to:1e3,unit:"o",long:"octets"},{from:1e3,to:1e6,unit:"ko",long:"kilooctets"},{from:1e6,to:1e9,unit:"Mo",long:"megaoctets"},{from:1e9,to:1e12,unit:"Go",long:"gigaoctets"},{from:1e12,to:1e15,unit:"To",long:"teraoctets"},{from:1e15,to:1e18,unit:"Po",long:"petaoctets"},{from:1e18,to:1e21,unit:"Eo",long:"exaoctets"},{from:1e21,to:1e24,unit:"Zo",long:"zettaoctets"},{from:1e24,to:1e27,unit:"Yo",long:"yottaoctets"}],iec:[{from:0,to:Math.pow(1024,1),unit:"B",long:"bytes"},{from:Math.pow(1024,1),to:Math.pow(1024,2),unit:"KiB",long:"kibibytes"},{from:Math.pow(1024,2),to:Math.pow(1024,3),unit:"MiB",long:"mebibytes"},{from:Math.pow(1024,3),to:Math.pow(1024,4),unit:"GiB",long:"gibibytes"},{from:Math.pow(1024,4),to:Math.pow(1024,5),unit:"TiB",long:"tebibytes"},{from:Math.pow(1024,5),to:Math.pow(1024,6),unit:"PiB",long:"pebibytes"},{from:Math.pow(1024,6),to:Math.pow(1024,7),unit:"EiB",long:"exbibytes"},{from:Math.pow(1024,7),to:Math.pow(1024,8),unit:"ZiB",long:"zebibytes"},{from:Math.pow(1024,8),to:Math.pow(1024,9),unit:"YiB",long:"yobibytes"}],iec_octet:[{from:0,to:Math.pow(1024,1),unit:"o",long:"octets"},{from:Math.pow(1024,1),to:Math.pow(1024,2),unit:"Kio",long:"kibioctets"},{from:Math.pow(1024,2),to:Math.pow(1024,3),unit:"Mio",long:"mebioctets"},{from:Math.pow(1024,3),to:Math.pow(1024,4),unit:"Gio",long:"gibioctets"},{from:Math.pow(1024,4),to:Math.pow(1024,5),unit:"Tio",long:"tebioctets"},{from:Math.pow(1024,5),to:Math.pow(1024,6),unit:"Pio",long:"pebioctets"},{from:Math.pow(1024,6),to:Math.pow(1024,7),unit:"Eio",long:"exbioctets"},{from:Math.pow(1024,7),to:Math.pow(1024,8),unit:"Zio",long:"zebioctets"},{from:Math.pow(1024,8),to:Math.pow(1024,9),unit:"Yio",long:"yobioctets"}]};class ln{constructor(e,t){t=Object.assign({units:"metric",precision:1,locale:void 0},sn,t),on.set(this,t),Object.assign(an,t.customUnits);const n=e<0?"-":"";e=Math.abs(e);const i=an[t.units];if(!i)throw new Error(`Invalid units specified: ${t.units}`);{const r=i.find((t=>e>=t.from&&e<t.to));if(r){const i=new Intl.NumberFormat(t.locale,{style:"decimal",maximumFractionDigits:t.precision}),s=0===r.from?n+i.format(e):n+i.format(e/r.from);this.value=s,this.unit=r.unit,this.long=r.long}else this.value=n+e,this.unit="",this.long=""}}toString(){const e=on.get(this);return e.toStringFn?e.toStringFn.bind(this)():`${this.value} ${this.unit}`}}function dn(e,t){return new ln(e,t)}dn.defaultOptions=function(e){sn=e};const hn=dn;var cn=(e,t,n)=>new Promise(((i,r)=>{var s=e=>{try{a(n.next(e))}catch(e){r(e)}},o=e=>{try{a(n.throw(e))}catch(e){r(e)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())}));const un=class e{constructor(t=e.DEFAULT_MAX_BYTES,n="text"){this.maxBytes=t,this.fileType=n}loadFromFile(e,t,n){return cn(this,null,(function*(){if(this.canLoad(t))return new Promise(((i,r)=>{const s=new FileReader,o=this;let a="";switch(s.onload=function(e){var t,n;if("string"==typeof(null==(t=e.target)?void 0:t.result)){let t=null==(n=e.target)?void 0:n.result;a+=t}else r("Unable to load read file as text.")},s.onloadend=function(e){i(o.loadFromString(a,t,n))},s.onerror=function(e){r(e)},this.fileType){case"dataurl":s.readAsDataURL(e);break;case"arraybuffer":throw new Error("Not Implemented");default:s.readAsText(e)}}))}))}load(e,t){return cn(this,null,(function*(){let n=e.type;switch(e.kind){case"string":return new Promise(((i,r)=>{e.getAsString((e=>{"string"!=typeof e&&r(new Error("Could not load item as string. Data was type: "+typeof e));let s=this.loadFromString(e,n,t);i(s)}))}));case"file":let i=e.getAsFile();if(i){let e=!0;if((null==i?void 0:i.size)>this.maxBytes&&(e=confirm(`File '${i.name}' has a size of ${hn(i.size)}. Are you sure you want to load the file? The page may become unresponsive.`)),e)return yield this.loadFromFile(i,n,t);throw new Error(`Could not load file '${i.name}'. It's size ${hn(i.size)} exceedes the limit of ${hn(this.maxBytes)}`)}throw new Error("Could not load item as file.");default:throw new Error(`Unknown item kind: ${e.kind}`)}}))}};un.DEFAULT_MAX_BYTES=1048576;let pn=un;const gn=["http://","https://","ftp://","ws://","wss://"];function fn(e){try{let t=new URL(e);return"file:///"==t.protocol||/^[a-zA-Z]:/.test(t.protocol)}catch(e){}return!1}const mn="Sanitizer"in window?new Sanitizer({allowCustomElements:!0}):null,vn=document.createElement("template");function bn(e){vn.innerHTML="<svg></svg>",mn?vn.content.firstElementChild.setHTML(e,mn):vn.content.firstElementChild.innerHTML=e;let t=vn.content.firstElementChild,n=null;return n=t.childElementCount<2?t.firstElementChild:Array.from(t.childNodes),n}document.createElement("template");const yn=new class extends pn{constructor(){super()}canLoad(e){return!0}loadFromFile(e,t,n){return i=this,r=function*(){if(this.canLoad(t)){let n=new FileReader,i=this.createElement(t),r="";return n.onload=function(e){var t;if("string"==typeof(null==(t=e.target)?void 0:t.result)){let t=e.target.result;r+=t}},n.onloadend=e=>{this.setDataUrl(i,r)},n.readAsDataURL(e),i}},new Promise(((e,t)=>{var n=e=>{try{o(r.next(e))}catch(e){t(e)}},s=e=>{try{o(r.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,s);o((r=r.apply(i,null)).next())}));var i,r}loadFromString(e,t,n){if(this.canLoad(t)&&0!=(i=e).length&&null!=i&&("file:///"==document.location.protocol&&i.startsWith("file:///")||gn.some((e=>i.startsWith(e))))){let n=this.createElement(t);return this.setDataUrl(n,e),n}var i}setDataUrl(e,t){e instanceof HTMLImageElement?e.src=t:e.setAttribute("data",t)}createElement(e){if(e.startsWith("image/")){let e=document.createElement("img");return e.src="",e.setAttribute("loading","lazy"),e.addEventListener("load",(function(e){let t=e.target;En(t,"height",t.naturalHeight.toString()),En(t,"width",t.naturalWidth.toString())})),e}{let t=document.createElement("object");return t.setAttribute("type",e),t}}},wn=yn;function En(e,t,n){let i=e.getAttribute(t);""!=i&&null!=i||e.setAttribute(t,n)}const Sn=new class extends pn{canLoad(e){return e.startsWith("text/html")||e.startsWith("application/html")}loadFromString(e,t,n){if(!n||!this.canLoad(t))return;let i=function(e){vn.innerHTML="",mn?vn.setHTML(e,mn):vn.innerHTML=e;let t=null;return t=vn.content.childElementCount<2?vn.content.firstElementChild:Array.from(vn.content.childNodes),t}(e);if(null==i)throw new Error(`Could not parse string ${e} as html`);if(i instanceof HTMLUnknownElement){let e=document.createElement("div"),t=!1;for(let n of i.childNodes)n instanceof HTMLElement&&!(n instanceof HTMLUnknownElement)&&(e.appendChild(n),t=!0);t&&(i=e)}return i}},xn=Sn;document.createElement("template");const Tn=new class extends pn{canLoad(e){return e.startsWith("text/plain")}loadFromString(e,t,n){if(this.canLoad(t)){let t=document.createElement("textarea");return t.innerText=e,t}}},Cn=new class extends pn{constructor(){super()}canLoad(e){return"text/uri-list"==e||"text/x-moz-url"==e||"text/x-moz-url-data"==e}loadFromString(e,t,n){if("text/uri-list"==t||"text/x-moz-url"==t){let t=e.split("\n"),n=t.filter(((e,t)=>t%2==0)),r=t.filter(((e,t)=>t%2==1)),s=n.map(((e,t)=>({url:e,name:r[t]})));if(s=s.filter((e=>e.url&&URL.canParse(e.url))),s.length>0){let e=[];for(let t of s){let n=this.createUriElement(t.url,t.name);n&&(n.style.flexGrow="1",e.push(n))}if(e.length>0){var i=document.createElement("div");return i.style.display="flex",i.append(...e),i}}}else if(URL.canParse(e))return this.createUriElement(e)}createUriElement(e,t){if(!fn(e)){let n=document.createElement("object");return n.setAttribute("data",e),n.setAttribute("name",null!=t?t:e),n}}},Dn=Cn,kn=new class extends pn{canLoad(e){return e.startsWith("image/svg+xml")}loadFromString(e,t,n){if(!n||!this.canLoad(t))return;let i=bn(e);if(null==i||i instanceof HTMLUnknownElement)throw new Error(`Could not parse string ${e} as svg`);return i}},Mn=kn,$n=new class extends pn{canLoad(e){return e.startsWith("text/xml")}loadFromString(e,t,n){if(!n||!this.canLoad(t))return;let i=bn(e);if(null==i||i instanceof HTMLUnknownElement)throw new Error(`Could not parse string ${e} as svg`);return i}},Ln=$n,An=new class extends pn{canLoad(e){return e.startsWith("image/")}loadFromFile(e,t,n){return i=this,r=function*(){if(this.canLoad(t)){let t=new FileReader,n=document.createElementNS("http://www.w3.org/2000/svg","image"),i="";return t.onload=function(e){var t;if("string"==typeof(null==(t=e.target)?void 0:t.result)){let t=e.target.result;i+=t}},t.onloadend=e=>{n.setAttribute("href",i)},t.readAsDataURL(e),n}},new Promise(((e,t)=>{var n=e=>{try{o(r.next(e))}catch(e){t(e)}},s=e=>{try{o(r.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,s);o((r=r.apply(i,null)).next())}));var i,r}loadFromString(e,t,n){if(!this.canLoad(t))return;let i=document.createElementNS("http://www.w3.org/2000/svg","image");return i.setAttribute("href",e),i}},Bn=An,On=new class extends pn{constructor(){super()}canLoad(e){return"text/uri-list"==e||"text/x-moz-url"==e||"text/x-moz-url-data"==e}loadFromString(e,t,n){if("text/uri-list"==t||"text/x-moz-url"==t){let t=e.split("\n"),n=t.filter(((e,t)=>t%2==0)),i=t.filter(((e,t)=>t%2==1)),r=n.map(((e,t)=>({url:e,name:i[t]})));if(r=r.filter((e=>e.url&&URL.canParse(e.url))),r.length>0){let e=[];for(let t of r){let n=this.createUriElement(t.url,t.name);n&&(n.style.flexGrow="1",e.push(n))}if(e.length>0)return e}}else if(URL.canParse(e))return this.createUriElement(e)}createUriElement(e,t){if(!fn(e)){let t=document.createElementNS("http://www.w3.org/2000/svg","image");return t.setAttribute("href",e),t}}},Pn=On;class Rn extends pn{constructor(e){super(),this.loaders=e}canLoad(e){for(let t of this.loaders)if(t.canLoad(e))return!0;return!1}loadFromFile(e,t,n){return i=this,r=function*(){if(this.canLoad(t))for(let i of this.loaders)if(i.canLoad(t))try{let r=yield i.loadFromFile(e,t,n);if(r)return r}catch(e){console.warn(e)}},new Promise(((e,t)=>{var n=e=>{try{o(r.next(e))}catch(e){t(e)}},s=e=>{try{o(r.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,s);o((r=r.apply(i,null)).next())}));var i,r}loadFromString(e,t,n){for(let i of this.loaders)if(i.canLoad(t))try{let r=i.loadFromString(e,t,n);if(r)return r}catch(e){console.warn(e)}}}const Nn=new nn([{type:"file",loader:new Rn([xn,Mn,wn])},{type:"string",loader:xn},{type:"string",loader:Mn},{type:"string",loader:Dn},{type:"string",loader:Tn},{type:"string",loader:wn}]),In=new nn([{type:"file",loader:new Rn([Ln,Mn,Bn,Pn,Dn,Tn,xn])},{type:"string",loader:Ln},{type:"string",loader:Mn},{type:"string",loader:Bn},{type:"string",loader:Pn},{type:"string",loader:Dn},{type:"string",loader:Tn},{type:"string",loader:xn}]);function zn(e){let t=e.assignedElements(),n=[],i=[];for(let e of t)if(e instanceof HTMLSlotElement){let t=zn(e);n=n.concat(t.assignedItems),i=i.concat(t.slots)}else n.push(e);return{assignedItems:n,slots:i}}const _n={setData:function(e,t){if(t instanceof Element)Fn(e,t,t.outerHTML,t.namespaceURI);else if("slot"in t){let n=document.createElement("div"),i=window.getComputedStyle(t.slot);for(let[e,t]of Object.entries(i))n.style.setProperty(e,t);n.innerHTML=t.assignedItems.map((e=>e.outerHTML)).join("\n"),e.setDragImage(n,0,0),Fn(e,t.slot,n.innerHTML,"http://www.w3.org/1999/xhtml")}else{let n=Object.groupBy(t.assignedItems,(e=>{var t;return null!=(t=e.namespaceURI)?t:""}));for(let[i,r]of Object.entries(n))""!=i&&Fn(e,t.foreignObject,r,i);Fn(e,t.foreignObject,t.foreignObject.outerHTML,t.foreignObject.namespaceURI)}}},Hn=new class{constructor(){this._dataTransfer=null,this._transfered=!1,this.serialiser=_n}get internalDataTransfered(){return this._transfered}get internalDataTransfer(){if(this._dataTransfer)return this._dataTransfer}hasData(){return null!=this._dataTransfer&&!this._transfered}mountData(e,t,n){this._transfered=!1,this.serialiser.setData(e,n),this._dataTransfer={source:t,content:n}}ummount(){this._dataTransfer=null,this._transfered=!1}transferInternalData(e,t){if(this._dataTransfer&&!this._transfered){let n;this._transfered=!0;let i=this._dataTransfer.content;return n=i instanceof Element?[i]:"slot"in i?t instanceof Element&&!t.contains(i.slot)||"copy"==e.dropEffect?i.assignedItems:i.slot:t instanceof SVGElement?i.foreignObject:i.assignedItems,"copy"==e.dropEffect&&(n=Array.isArray(n)?n.map((e=>e.cloneNode(!0))):n.cloneNode(!0)),n}}mountElement(e,t,n){if(this._transfered=!1,(n=null!=n?n:t)instanceof HTMLSlotElement){let i={slot:n,assignedItems:zn(n).assignedItems};this.mountData(e,t,i)}else if(n instanceof SVGForeignObjectElement){let i={foreignObject:n,assignedItems:Array.from(n.childNodes)};this.mountData(e,t,i)}else n instanceof Element&&this.mountData(e,t,n)}};function Fn(e,t,n,i){let r,s,o;switch(r=n?"string"==typeof n?n:n.map((e=>e.outerHTML)).join("\n"):t.outerHTML,null==i&&(i=t.namespaceURI),t instanceof HTMLElement?o={width:`${(a=t).offsetWidth}`,height:`${a.offsetHeight}`}:t instanceof SVGGraphicsElement?o=function(e){if(e instanceof SVGGraphicsElement){let t=e.getBBox();return{width:`${t.width}`,height:`${t.height}`}}return{}}(t):t instanceof MathMLElement?o={}:console.warn(`mimeType paramters for ${t.constructor} is unknown`),i){case"http://www.w3.org/1999/xhtml":s="text/html";break;case"http://www.w3.org/2000/svg":s="image/svg+xml";break;case"http://www.w3.org/1998/Math/MathML":s="application/mathml+xml";break;default:throw new Error(`Namespace ${i} is unknown`)}var a;let l=function(e,t){let n="";return t&&(n=function(e){return Object.entries(e).filter((([e,t])=>t.length>0)).map((([e,t])=>`${e}=${t}`)).join(";")}(t)),n.length>0?`${e};${n}`:e}(s,o);return e.setData(s,r),{format:l,data:r}}function Vn(e,t,n,i){let{foWidth:r,foHeight:s}=function(e,t,n){return(null==e?void 0:e.parameters)&&(0!=t&&Number.isFinite(t)||!e.parameters.width||(t=parseFloat(e.parameters.width)),0!=n&&Number.isFinite(n)||!e.parameters.height||(n=parseFloat(e.parameters.height))),{foWidth:t,foHeight:n}}(e,t,n);i.setAttribute("width",r.toString()),i.setAttribute("height",s.toString())}function jn(e,t){return t||(t=Array.from(e.childNodes).filter((e=>e instanceof Element))),Gn(t)}function Gn(e){let t=e.map((e=>Un(e)));return{width:Math.max(...t.map((e=>e.width))),height:t.reduce(((e,t)=>e+t.height),0)}}const Wn=new class{canConvert(e,t){return!0}canConvertSequence(e,t){return!0}convert(e,t){if(e instanceof SVGElement)return e;let{width:n,height:i}=Un(e);Xn(e);let r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return r.append(e),Vn(t,n,i,r),r}convertSequence(e,t){if(e.every((e=>e instanceof SVGElement)))return e;let n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),{width:i,height:r}=jn(n,e);Vn(t,i,r,n);for(let t of e)Xn(t);return n.append(...e),n}};function Xn(e){let t=e.namespaceURI;t&&e.setAttribute("xlmns",t)}function Un(e){let t=0,n=0;try{let i=e.getBoundingClientRect();if(e.hasAttribute("width")){let n=e.getAttribute("width");t=parseFloat(n),Number.isFinite(t)||(t=i.width)}else t=i.width;if(e.hasAttribute("height")){let t=e.getAttribute("height");n=parseFloat(t),Number.isFinite(n)||(n=i.height)}else n=i.height}catch(t){console.error(t),console.error(e)}return{width:t,height:n}}class Yn{constructor(e,t,n,i=!0){this.parser=e,this.source=t,this.converter=n,this.allowInternal=i,this.dropEnabled=!0}handleDragEnter(e,t){this.canHandleDrop(e,t)?(this.setDropEffect(e),t.showDropPlaceholder(e)):t.hideDropPlaceholder(e)}setDropEffect(e){e.dataTransfer&&(e.ctrlKey?e.dataTransfer.dropEffect="copy":e.shiftKey?e.dataTransfer.dropEffect="link":e.dataTransfer.dropEffect="move")}handleDragOver(e,t){!e.defaultPrevented&&this.canHandleDrop(e,t)?(t.dropPlaceholderIsVisible()||t.showDropPlaceholder(e),e.preventDefault(),this.setDropEffect(e),t.updateDropPlaceholder(e)):t.hideDropPlaceholder(e)}handleDragLeave(e,t){e.currentTarget==t&&t.hideDropPlaceholder(e)}canHandleDrop(e,t){return!(!this.dropEnabled||!e.dataTransfer)&&this.canHandleDataTransfer(e.dataTransfer,t)}canHandleDataTransfer(e,t){if(this.source&&null!=this.source.internalDataTransfer){let e=this.source.internalDataTransfer.source;if(e){if(e==t||e.contains(t))return!1;let n=e.querySelectorAll("slot");for(let e of n){let n=zn(e);for(let e of n.assignedItems)if(e==t||e.contains(t))return!1;if(e.contains(t))return!1}}}return e.types.some((e=>this.parser.canParseType(e)))}resolveInternalDrop(e,t){var n;let i,r=null==(n=this.source)?void 0:n.transferInternalData(e,t);if(r)return i="internal",r}handleDrop(e,t,n,i){return r=this,s=function*(){try{if(e.dataTransfer&&!e.defaultPrevented&&this.canHandleDrop(e,t)){if(this.setDropEffect(e),"link"==e.dataTransfer.dropEffect)return e.dataTransfer.dropEffect="none",!1;let r=!1;if(this.allowInternal&&"copy"!=e.dataTransfer.dropEffect){let s=this.resolveInternalDrop(e.dataTransfer,null!=i?i:t);if(s&&this.elementAreConvertable(s)){let t;r=!0,n.before&&(t=n.before()),"move"==e.dataTransfer.dropEffect?setTimeout((()=>{n.resolveDrop({data:this.convert(s),kind:"internal"},t),n.after&&n.after(t)}),20):(n.resolveDrop({data:this.convert(s),kind:"internal"},t),n.after&&n.after(t))}}if(!r){let t,i=this.parser.parse(e.dataTransfer,e);for(i.done||(e.preventDefault(),e.stopPropagation());!i.done;){let e=yield i.getValue();if(e){let i=e.content;if(this.elementAreConvertable(i,e.mimeType)&&(!r&&n.before&&(t=n.before()),r=!0,!n.resolveDrop({data:this.convert(i,e.mimeType),kind:e.type,mimeType:e.mimeType},t)))break}i.next()}r&&n.after&&n.after(t)}return r?(e.preventDefault(),e.stopPropagation()):e.dataTransfer.dropEffect="none",!0}}catch(t){console.error(t),e.dataTransfer&&(e.dataTransfer.dropEffect="none")}finally{t.hideDropPlaceholder(e)}},new Promise(((e,t)=>{var n=e=>{try{o(s.next(e))}catch(e){t(e)}},i=e=>{try{o(s.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((s=s.apply(r,null)).next())}));var r,s}elementAreConvertable(e,t){return!(null==e||Array.isArray(e)&&0==e.length)&&(!this.converter||(Array.isArray(e)?this.converter.canConvertSequence(e,t):this.converter.canConvert(e,t)))}convert(e,t){var n;if(this.converter){if(!Array.isArray(e))return null!=(n=this.converter.convert(e))?n:e;let i,r=this.converter;if(i=Array.isArray(e)?1==e.length?r.convert(e[0],t):r.convertSequence(e,t):r.convert(e,t),null==i||Array.isArray(i)&&0==i.length)throw new Error("unable to convert element");return i}return e}}class qn extends Yn{constructor(e,t,n){super(e,t,n),this.dropEnabled=!0}canHandleDataTransfer(e,t){let n=super.canHandleDataTransfer(e,t);if(!n)return n;if(this.source&&null!=this.source.internalDataTransfer){let e=this.source.internalDataTransfer.source;if(e){if(e==t||e.contains(t))return!1;let n=[];for(e instanceof HTMLSlotElement&&n.push(e);n.length>0;){let e=n.pop().assignedElements();if(e.some((e=>e==t||e.contains(t))))return!1;n=n.concat(e.filter((e=>e instanceof HTMLSlotElement)))}}}return!0}}const Kn=new class{constructor(e="all"){this.effectAllowed=e,this.dataTransferSource=Hn,this.enabled=!0,this.deleteElementListener=null}canHandleDrag(e,t,n){var i;if(this.enabled&&!e.defaultPrevented&&(n=this.determineDragSource(e,n),e.dataTransfer&&n)){if(n instanceof HTMLSlotElement)return!0;if(t.contains(n)||(null==(i=t.shadowRoot)?void 0:i.contains(n)))return!0}return!1}determineDragSource(e,t){let n=e.composedPath()[0];return n instanceof HTMLElement&&(t=null!=t?t:n),t}handleDragStart(e,t,n,i,r){if(this.canHandleDrag(e,t,r)&&(r=this.determineDragSource(e,r),e.dataTransfer&&r))return this.dataTransferSource.mountElement(e.dataTransfer,r,n),e.dataTransfer.effectAllowed=this.effectAllowed,e.stopPropagation(),this.deleteElementListener=e=>{var t;if(e.altKey&&this.dataTransferSource.hasData()&&!this.dataTransferSource.internalDataTransfered){let n=null==(t=this.dataTransferSource.internalDataTransfer)?void 0:t.content;if(n){if(n instanceof Element)n.remove();else if("slot"in n)for(let e of n.assignedItems)e.remove();else for(let e of n.assignedItems)e.remove();return this.dataTransferSource.ummount(),e.preventDefault(),!0}}return!1},t.addEventListener("dragover",this.deleteElementListener),!0}handleDragEnd(e,t){var n;if(this.deleteElementListener&&(t.removeEventListener("dragover",this.deleteElementListener),this.deleteElementListener=null),e.dataTransfer){if("move"===e.dataTransfer.dropEffect&&!this.dataTransferSource.internalDataTransfered){let e=null==(n=this.dataTransferSource.internalDataTransfer)?void 0:n.content;if(e)if(e instanceof HTMLSlotElement){let t=zn(e);for(let e of t.assignedItems)e.remove()}else e instanceof Element&&e.remove()}this.dataTransferSource.ummount()}}};function Qn(e){let t=!1;return e instanceof KeyboardEvent?"Enter"==e.key&&(t=!0):e instanceof MouseEvent&&(t=!0),t}function Zn(e,t){let n=e,i=[];for(;n!=t&&null!=n;)i.push(n),n=n.parentElement;return null==n?null:i}function Jn(e,t,n,i){var r,s,o,a,l;let d,h,c;if("function"==typeof e.computedStyleMap){let t=e.computedStyleMap();d=null==(r=t.get("display"))?void 0:r.toString(),h=null==(s=t.get("flex-direction"))?void 0:s.toString(),c=null==(o=t.get("flex-wrap"))?void 0:o.toString()}else{let t=window.getComputedStyle(e);d=t.display,h=t.flexDirection,c=t.flexWrap}let u,p,g=!0,f=!1;if("flex"==d){if("row-reverse"==h||"column-reverse"==h){if("wrap-reverse"!=c)throw new Error(`Not supported flex-wrap '${c}' and flex-direction '${h}'. When usign flex-direction row-reverse/column-reverse you must use flex-wrap wrap-reverse.`);t=t.reverse()}g=null!=(a=null==h?void 0:h.startsWith("row"))&&a,f=null!=(l=null==c?void 0:c.endsWith("reverse"))&&l}let m,v=function(e,t,n,i,r=0,s=-1){s<=0&&(s=e.length-1);let o=!i;if(o){let e=n;n=t,t=e}let a=r,l=s;for(;r<=s;){let i=r+Math.floor((s-r)/2),d=e[i].getBoundingClientRect(),h=d.top,c=h+d.height,u=d.left,p=d.left+d.width;if(o){let e=h,t=c;h=u,c=p,u=e,p=t}if(h<=n&&n<=c&&u<=t&&t<=p)return i;c<n?r=i+1:n<h?s=i-1:u<t?r=i+1:t<p&&(s=i-1),r!=s&&(a=r,l=s)}return a<l?[a,l]:[l,a]}(t,n,i,g);if("number"==typeof v){let e=t[v];if(m=v,e){let t,r,s=e.getBoundingClientRect();g?(r=n,t=s.left+s.width/2):(r=i,t=s.top+s.height/2),r<=t&&(m=v-1)}return u=t[m],p=t[m+1],{previousElement:u,nextElement:p,hoveredElement:e,flowDirectionX:g,reversedFlow:f}}return m=v[0],u=t[m],p=t[m+1],{previousElement:u,nextElement:p,flowDirectionX:g,reversedFlow:f}}var ei=Object.defineProperty,ti=Object.getOwnPropertyDescriptor,ni=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?ti(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&ei(t,n,s),s};const ii="--edit-border-size";let ri=class extends Ce{constructor(){super(),this.dragSource=Kn,this.snapX=50,this.snapY=50,this.snapRotate=10,this._dataTransferParser=null,this.selectMaskImage=!1,this._internals=this.attachInternals(),this.dropTarget=new qn(In,Hn,Wn),this.addEventListener("mousedown",this.handleMouseDown),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.addEventListener("contextmenu",(e=>{if(this._internals.states.has("editing")){e.preventDefault(),this.editContextMenu.style.left="0px",this.editContextMenu.style.top="0px",this.editContextMenu.showPopover();let t=this.editContextMenu.getBoundingClientRect(),n=e.clientX-t.x,i=e.clientY-t.y;this.editContextMenu.style.left=`${n}px`,this.editContextMenu.style.top=`${i}px`}})),new MutationObserver((e=>{for(let t of e)if(t.target.parentElement!=this){let e=t.target;if(t.removedNodes.length>0&&0==e.childElementCount&&e instanceof SVGElement&&(e instanceof SVGForeignObjectElement||e instanceof SVGGElement||e instanceof SVGSVGElement)){let t=Zn(e,this);t&&(t.slice(1).some((e=>e instanceof SVGForeignObjectElement))||e.remove())}}})).observe(this,{subtree:!0,childList:!0})}snapXChanged(e,t){this.paintDropSnapLines(!0)}snapYChanged(e,t){this.paintDropSnapLines(!0)}dropPlaceholderIsVisible(){return this._internals.states.has("dragover")}showDropPlaceholder(e){this._internals.states.add("dragover"),this.paintDropSnapLines()}updateDropPlaceholder(e){let t=this.calculateDropMarkerPosition(e,e.ctrlKey);t.x=t.x-this.dropMarker.clientWidth/2,t.y=t.y-this.dropMarker.clientHeight/2,this.dropMarker.style.left=`${t.x}px`,this.dropMarker.style.top=`${t.y}px`}hideDropPlaceholder(e){this._internals.states.delete("dragover")}get dataTransferParser(){var e;return null!=(e=this._dataTransferParser)?e:In}set dataTransferParser(e){this._dataTransferParser=e}setEditBoxFocusOn(e){let t=this.getFocusedSvgElement(e);if(null!=t){let e=this.editSvgBox;e.srcElement=t,this.resizeEditBoxToSvgContent(),this._internals.states.add("editing"),setTimeout((function(){e.focus()}))}else this.clearEditBox()}clearEditBox(){this.hideRotation(),this._internals.states.delete("editing"),this.editSvgBox.srcElement=null,this.getSvg().style.pointerEvents="",this.editResizeHandles.cancelResize(),this.editRotationHandle.cancelRotate()}resizeEditBoxToSvgContent(){let e=Ft(this.editSvgBox.srcElement,this.getSvg());this.resizeEditBoxToBBox(e)}resizeEditBoxToBBox(e){let t=this.editSvgBox.firstElementChild,n=this.editBorderSize;this.editSvgBox.style.left=e.x-n+"px",this.editSvgBox.style.top=e.y-n+"px",t.style.width=`${e.width}px`,t.style.height=`${e.height}px`}getEditBoxBBox(){let e=this.editSvgBox.firstElementChild,t=this.editBorderSize;return new DOMRect(parseInt(this.editSvgBox.style.left)+t,parseInt(this.editSvgBox.style.top)+t,parseInt(e.style.width),parseInt(e.style.height))}moveEditBox(e,t){let n=this.editSvgBox.style.left,i=this.editSvgBox.style.top;this.editSvgBox.style.left=`${parseFloat(n)+e}px`,this.editSvgBox.style.top=`${parseFloat(i)+t}px`,this.resuzeSvgContentToEditBox()}resuzeSvgContentToEditBox(){Gt(this.editSvgBox.srcElement,this.getEditBoxBBox())}getElementAt(e,t){let n=this.getSvg().style.pointerEvents;this.getSvg().style.pointerEvents="";let i=document.elementFromPoint(e,t);return this.getSvg().style.pointerEvents=n,i}getFocusedSvgElement(e){let t=this.getSvg();if(e==t)return null;let n=null;if(e.parentNode==t)n=e;else{let i=e,r=i;for(;null!=r&&(r=r.closest("svg"),r!=t);)i=r,r=null==r?void 0:r.parentElement;r==t&&(n=i instanceof SVGElement?i:i.closest("foreignObject"))}return n}handleEditSvg_keydown(e){switch(e.key){case"Escape":this.clearEditBox();break;case"ArrowLeft":this.moveEditBox(-1,0);break;case"ArrowUp":this.moveEditBox(0,-1);break;case"ArrowDown":this.moveEditBox(0,1);break;case"ArrowRight":this.moveEditBox(1,0);break;case"PageUp":e.ctrlKey?this.moveEditBoxMoveElementTopOrBottom("top"):this.moveEditBoxMoveElement(1);break;case"PageDown":e.ctrlKey?this.moveEditBoxMoveElementTopOrBottom("bottom"):this.moveEditBoxMoveElement(-1);break;case"Shift":this.toggleRotation();break;case"Delete":this.editSvgBox.srcElement.remove(),this.clearEditBox();break;case"Control":this.getSvg().style.pointerEvents="none";break;case"C":e.ctrlKey&&this.copyEditBoxElement();break;case"P":e.ctrlKey&&this.pasteElement();break;case"X":e.ctrlKey&&this.cutEditBoxElement()}}cutEditBoxElement(){throw new Error("Method not implemented.")}pasteElement(){throw new Error("Method not implemented.")}copyEditBoxElement(){throw new Error("Method not implemented.")}moveEditBoxMoveElementTopOrBottom(e){}moveEditBoxMoveElement(e){}handleEditSvg_dragstart(e){var t;if(this.dragSource.canHandleDrag(e,this.editSvgBox)){let n=this.editSvgBox.srcElement,i=this.getSvg();if(n&&e.dataTransfer){let r=n;for(;i!=r.parentElement;)r=r.parentElement;if(e.dataTransfer.setDragImage(r,0,0),n instanceof HTMLElement)this.dragSource.dataTransferSource.mountElement(e.dataTransfer,n);else if(n instanceof SVGGraphicsElement){let i=n.cloneNode(!0);null==(t=n.parentElement)||t.appendChild(i),Gt(i,Ft(n,this.getSvg())),Xt(i,!0),this.dragSource.dataTransferSource.mountElement(e.dataTransfer,this.editSvgBox,n),n instanceof SVGForeignObjectElement||(this.dragSource.dataTransferSource.mountElement(e.dataTransfer,this.editSvgBox,n),e.dataTransfer.setData("image/svg+xml",i.outerHTML)),n instanceof SVGSVGElement||e.dataTransfer.setData("text/xml",i.outerHTML),i.remove()}else this.dragSource.dataTransferSource.mountElement(e.dataTransfer,this.editSvgBox,n);e.dataTransfer.effectAllowed=this.dragSource.effectAllowed,e.stopPropagation(),this.clearEditBox(),this.handleDragStartHelper()}return!0}}handleEditSvgResize_resizing(e){e.preventDefault();let t=Ft(this.editSvgBox.srcElement,this.getSvg()),n=!e.detail.ctrlKey,i=e.detail.shiftKey,r=t.width/t.height,s=e.detail.deltaX,o=e.detail.deltaY;if((e.detail.handle&Ot.Right)>0)t.width+=s,n&&(t.width=Ut(t.width,this.snapX)),t.width<=0&&(t.width=1);else if((e.detail.handle&Ot.Left)>0){let e=t.x;t.x+=s,n&&(t.x=Ut(t.x,this.snapX)),t.width-=t.x-e,t.width<=0&&(t.x+=t.width-1,t.width=1)}if((e.detail.handle&Ot.Bottom)>0)t.height+=o,n&&(t.height=Ut(t.height,this.snapY)),t.height<=0&&(t.height=1);else if((e.detail.handle&Ot.Top)>0){let e=t.y;t.y+=o,n&&(t.y=Ut(t.y,this.snapY)),t.height-=t.y-e,t.height<=0&&(t.y+=t.height-1,t.height=1)}if(i){let n=(e.detail.handle&(Ot.Right|Ot.Left))>0;if((e.detail.handle&(Ot.Top|Ot.Bottom))>0&&n){let n=t.width/t.height;if(n>r){let n=r*t.height;e.detail.handle&Ot.Left&&(t.x-=n-t.width),t.width=n}else if(r>n){let n=t.width/r;e.detail.handle&Ot.Top&&(t.y-=n-t.height),t.height=n}}else if(n){let e=t.width/r;t.y-=(e-t.height)/2,t.height=e}else{let e=t.height*r;t.x-=(e-t.width)/2,t.width=e}}return this.resizeEditBoxToBBox(t),!0}handleEditSvgResize_resizingend(e){return e.preventDefault(),this.resuzeSvgContentToEditBox(),!0}handleEditSvgResize_resizingcanceled(e){return e.preventDefault(),this.resizeEditBoxToSvgContent(),!0}handleMouseDown(e){if((e.ctrlKey||null!=this.editSvgBox.srcElement)&&e.target instanceof Element){let t=this.getElementAt(e.clientX,e.clientY);this.selectMaskImage&&t instanceof SVGGraphicsElement?this.cliphPathImage(this.editSvgBox.srcElement,t):t&&t!=this&&(t instanceof SVGElement?this.setEditBoxFocusOn(t):setTimeout((()=>{document.activeElement!=t&&this.setEditBoxFocusOn(t)}),0)),this.selectMaskImage=!1}}cliphPathImage(e,t){let n=this.getSvg(),i=n.querySelector("defs");null==i&&(i=document.createElementNS("http://www.w3.org/2000/svg","defs"),n.insertBefore(i,n.firstChild));let r=t.cloneNode(!0),s=Vt(e);if(s){let t=document.createElementNS("http://www.w3.org/2000/svg","mask");s.appendChild(r);let n=Ft(e),a=e.getCTM();if(a){let{scaleX:e,scaleY:t}=(o=a,{scaleX:Math.sqrt(o.a*o.a+o.b*o.b),scaleY:Math.sqrt(o.c*o.c+o.d*o.d)});n.width/=e,n.height/=t}Gt(r,n),r.removeAttribute("id"),r.setAttribute("fill","white"),t.appendChild(r),i.append(t),t.id=Zt(),e.setAttribute("mask",`url(#${t.id})`)}var o}toggleRotation(){""==this.editRotationHandle.style.display?this.showRotation():this.hideRotation()}showRotation(){this.editRotationHandle.style.display="block",this.editSvgBox.classList.add("rotating")}hideRotation(){this.editRotationHandle.style.display="",this.editSvgBox.classList.remove("rotating")}handleDragStart(e){e.target instanceof HTMLElement&&this.dragSource.handleDragStart(e,this,e.target)&&this.handleDragStartHelper()}handleDragStartHelper(){this._internals.states.add("dragging")}handleDragEnd(e){var t,n;this._internals.states.delete("dragging");let i=null==(t=this.dragSource.dataTransferSource.internalDataTransfer)?void 0:t.content;i&&("move"==(null==(n=e.dataTransfer)?void 0:n.dropEffect)&&i instanceof SVGGraphicsElement&&(this.getSvg().contains(i)||i.removeAttribute("transform")),i instanceof SVGForeignObjectElement&&0==i.childNodes.length&&i.remove()),this.dragSource.handleDragEnd(e,this)}handleDragEnter(e){this.dropTarget.handleDragEnter(e,this),this._internals.states.add("dragover")}handleDragLeave(e){this.dropTarget.handleDragLeave(e,this),this._internals.states.delete("dragover")}handleDragOver(e){this.dropTarget.handleDragOver(e,this)}handleDrop(e){return t=this,n=function*(){let t=this.calculateDropMarkerPosition(e,e.ctrlKey),n=!1;yield this.dropTarget.handleDrop(e,this,{resolveDrop:i=>{let r="string"==i.kind;if(r&&n)return!1;if(Array.isArray(i.data))for(let r of i.data)n=this.insertDroppedElement(r,e,t)||n;else n=this.insertDroppedElement(i.data,e,t)||n;return!n||!r}},this.getSvg()),this._internals.states.delete("dragover")},new Promise(((e,i)=>{var r=e=>{try{o(n.next(e))}catch(e){i(e)}},s=e=>{try{o(n.throw(e))}catch(e){i(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);o((n=n.apply(t,null)).next())}));var t,n}insertDroppedElement(e,t,n){var i;if(e instanceof SVGElement){if(Vt(e)!=this.getSvg()){if(this.getSvg().appendChild(e),e instanceof SVGGraphicsElement&&jt(e,n),e instanceof SVGForeignObjectElement){this.setForeignObjectContentDraggable(e);let t=e.querySelector("object")||e.querySelector("img");const r=this;if(t){let i=function(t){r.applyDroppedElementSize(t.target,e,n)};t.addEventListener("load",i)}else if("0"==e.getAttribute("width")||"0"==e.getAttribute("height")){let t=Array.from(e.childNodes);null==(i=this.shadowRoot)||i.append(...t);const{width:n,height:r}=Gn(t);e.setAttribute("width",n.toString()),e.setAttribute("height",r.toString()),e.append(...t)}}return!0}return e instanceof SVGGraphicsElement&&jt(e,n),!0}return console.error("Loaded element which we can't insert",e),!1}setForeignObjectContentDraggable(e){for(let t of e.childNodes)t instanceof HTMLElement&&t.setAttribute("draggable","true")}applyDroppedElementSize(e,t,n,i=100,r=100){if(t instanceof SVGForeignObjectElement){let{width:e,height:i}=jn(t);t.setAttribute("width",`${e}px`),t.setAttribute("height",`${i}px`),jt(t,new DOMPoint(n.x,n.y))}else{let e=t.getBBox();0==e.width||0==e.height?Gt(t,new DOMRect(n.x,n.y,i,r)):jt(t,new DOMPoint(n.x,n.y))}}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback()}calculateDropMarkerPosition(e,t=!1){let n=this.getBoundingClientRect(),i=new DOMPoint(e.clientX-n.x,e.clientY-n.y);return t||(i.x=Ut(i.x,this.snapX),i.y=Ut(i.y,this.snapY)),i.x=Math.max(0,Math.min(this.clientWidth,i.x)),i.y=Math.max(0,Math.min(this.clientHeight,i.y)),i}paintDropSnapLines(e=!1){var t,n;let i=this.dropSnapLines;if(i){let r=this.offsetWidth,s=this.offsetHeight,o=parseFloat(null!=(t=i.getAttribute("width"))?t:"0"),a=parseFloat(null!=(n=i.getAttribute("height"))?n:"0");if(o!=r||a!=s||e){i.setAttribute("width",r.toString()),i.setAttribute("height",s.toString());const e=i.getContext("2d");if(e.clearRect(0,0,i.width,i.height),e.setLineDash([5,5]),this.snapX)for(let t=this.snapX;t<r;t+=this.snapX)e.beginPath(),e.moveTo(t,0),e.lineTo(t,s),e.lineWidth=1,e.stroke();if(this.snapY)for(let t=this.snapY;t<s;t+=this.snapY)e.beginPath(),e.moveTo(0,t),e.lineTo(r,t),e.lineWidth=1,e.stroke()}}}getSvg(){return this.querySelector("svg")}get editBorderSize(){const e=getComputedStyle(this);let t=parseInt(e.getPropertyValue(ii));return Number.isNaN(t)?0:t}handleEditSvg_RemoveMaskSvg(e){Qn(e)&&(this.editContextMenu.hidePopover(),this.editSvgBox.srcElement.removeAttribute("mask"))}handleContextMeny_keydown(e){if(e.target instanceof HTMLLIElement)switch(e.key){case"ArrowUp":e.target.previousElementSibling&&e.target.previousElementSibling.focus();break;case"ArrowDown":e.target.nextElementSibling&&e.target.nextElementSibling.focus()}}handleEditSvg_MaskSvg(e){Qn(e)&&(this.editContextMenu.hidePopover(),this.selectMaskImage=!0)}handleEditSvgRotate_rotationstart(e){let t=this.editSvgBox.getBoundingClientRect();this.editRotationHandle.originX=t.left+t.width/2,this.editRotationHandle.originY=t.top+t.height/2;let n=this.getSvg().createSVGTransform();this.editSvgBox.srcElement.transform.baseVal.insertItemBefore(n,0)}handleEditSvgRotate_rotating(e){let t=this.editSvgBox.srcElement,n=e.detail.radians;!e.detail.ctrlKey&&this.snapRotate&&(n=Ut(n,this.snapRotate*Math.PI/180));let i=180*n/Math.PI;this.editSvgBox.style.transform=`rotate(${n}rad)`,t.transform.baseVal[0].setMatrix(new DOMMatrix);let r=function(e,t){let n=null;e.parentElement instanceof SVGGraphicsElement&&(n=e.parentElement.getCTM());let i=zt(Ht(e)),r=It(e),s=e.getCTM();s&&(i=i.matrixTransform(s)),n&&(i=i.matrixTransform(n.inverse()));let o=i.x-r.x,a=i.y-r.y,l=new DOMMatrix;return l.translateSelf(o,a).rotateSelf(t).translateSelf(-o,-a),l}(t,i);t.transform.baseVal[0].setMatrix(r)}handleEditSvgRotate_rotationend(e){this.handleEditSvgRotate_rotating(e),this.editSvgBox.srcElement.transform.baseVal.consolidate(),this.editSvgBox.style.transform="",this.resizeEditBoxToSvgContent()}handleEditSvgRotate_rotationcanceled(e){this.editSvgBox.style.transform="",this.editSvgBox.srcElement.transform.baseVal.removeItem(0)}};ni([j({converter:F})],ri.prototype,"snapX",2),ni([j({converter:F})],ri.prototype,"snapY",2),ni([j({converter:F})],ri.prototype,"snapRotate",2),ri=ni([De({name:"mmr-svg-painter",template:ut`
      <slot></slot>
      <div id="drop-overlay" class="overlay">
        <canvas width="0" height="0" ${gt("dropSnapLines")} id="snap-lines"></canvas>
        <svg width="20" height="20" id="marker" ${gt("dropMarker")} transform-origin="0 0">
          <line x1="0" y1="50%" x2="100%" y2="50%" stroke="black" />
          <line x1="50%" y1="0" x2="50%" y2="100%" stroke="black" />
          <line x1="0" y1="0" x2="100%" y2="100%" stroke="black" />
          <line x1="0" y1="100%" x2="100%" y2="0" stroke="black" />
        </svg>
      </div>
      <div id="edit-svg-overlay" class="overlay">
        <div id="edit-svg-box" ${gt("editSvgBox")} 
          draggable="true" tabindex="0"
          @keydown="${(e,t)=>e.handleEditSvg_keydown(t.event)}"
          @dragstart="${(e,t)=>e.handleEditSvg_dragstart(t.event)}">
          <div>
          <mmr-resize-handle
            ${gt("editResizeHandles")}
            id="svg-resize"
            @resizing="${(e,t)=>e.handleEditSvgResize_resizing(t.event)}"
            @resizeend="${(e,t)=>e.handleEditSvgResize_resizingend(t.event)}"
            @resizecanceled="${(e,t)=>e.handleEditSvgResize_resizingcanceled(t.event)}"
            id="resize-handles" exportparts="top,right,bottom,left,top-left,top-right,bottom-right,bottom-left">
            </mmr-resize-handle>
          </div>
        </div>
        <mmr-rotation-handle
          ${gt("editRotationHandle")}
            id="svg-rotate"
            @rotationstart="${(e,t)=>e.handleEditSvgRotate_rotationstart(t.event)}"
            @rotating="${(e,t)=>e.handleEditSvgRotate_rotating(t.event)}"
            @rotationend="${(e,t)=>e.handleEditSvgRotate_rotationend(t.event)}"
            @rotationcanceled="${(e,t)=>e.handleEditSvgRotate_rotationcanceled(t.event)}"
            id="rotation-handles">
        </mmr-rotation-handle>
        <div id="edit-context-menu" ${gt("editContextMenu")} popover>
          <ul @keydown="${(e,t)=>e.handleContextMeny_keydown(t.event)}">
            <li tabindex="1" autofocus @keydown="${(e,t)=>e.handleEditSvg_MaskSvg(t.event)}" @click="${(e,t)=>e.handleEditSvg_MaskSvg(t.event)}">Mask SVG</li>
            <li tabindex="2" @keydown="${(e,t)=>e.handleEditSvg_RemoveMaskSvg(t.event)}" @click="${(e,t)=>e.handleEditSvg_RemoveMaskSvg(t.event)}">Remove SVG mask</li>
          </ul>
        </div>
      </div>
     `,styles:xt`
    :host {
      overflow: hidden;
      min-width: 50px;
      min-height: 50px;
      ${ii}: 4px;
    }

    :host > mmr-resize-handle {
      --handle-size: 10px;
    }

    ::slotted(svg) {
        width: 100%;
        height: 100%;
    }

    :host {
      display: block;
      position: relative;
      height: max-content;
      width: max-content;
    }

    #edit-context-menu {
      position: fixed;
      pointer-events:all;
      margin: 0px;
      top: 0;
      left: 0;
    }

    #drop-overlay {
      pointer-events: none;
      background-color: rgba(0,0,0,0.2);
    }

    :host(:state(dragover)) #drop-overlay{
      display: block
    }

    :host(:state(editing)) #edit-svg-overlay{
      display: block
    }

    #edit-svg-overlay {
      pointer-events: none
    }

    #svg-rotate {
      display: none;
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: all;
      top: 0;
      left: 0;
    }

    .overlay {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #edit-svg-box {
      position: absolute;
      pointer-events: all;
      border: var(${ii}) dashed black;
      width: min-content;
      height: min-content;
    }

    #edit-svg-box.rotating {
      border-radius: 4px;
      border-style: dotted;
    }
      
    #snap-lines {
      width: 100%;
      height: 100%;
    }

    #marker {
      position: absolute;
      left: 0;
      top: 0;
    }

    #marker line {
      stroke-width: 2px;
    }
    `})],ri);var si=Object.defineProperty,oi=Object.defineProperties,ai=Object.getOwnPropertyDescriptor,li=Object.getOwnPropertyDescriptors,di=Object.getOwnPropertySymbols,hi=Object.prototype.hasOwnProperty,ci=Object.prototype.propertyIsEnumerable,ui=(e,t,n)=>t in e?si(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pi=(e,t)=>{for(var n in t||(t={}))hi.call(t,n)&&ui(e,n,t[n]);if(di)for(var n of di(t))ci.call(t,n)&&ui(e,n,t[n]);return e},gi=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?ai(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&si(t,n,s),s};const fi=ut`
<slot></slot>
<div id="pointer-capture" @pointerdown="${(e,t)=>e.handle_onpointerdown(t.event)}" @pointerup="${(e,t)=>e.handle_onpointerup(t.event)}" @pointerleave="${(e,t)=>e.handle_onpointerleave(t.event)}"></div>
`,mi=xt`
:host {
 cursor: url('data:image/svg+xml;utf8,${'<svg fill="white" xmlns="http://www.w3.org/2000/svg" viewport="0 0 52 52" width="52px" height="52px"><path stroke-width="1" stroke="black" d="M48.5,2h-3C44.7,2,44,2.7,44,3.5v7c0,0.9-1,1.5-1.6,0.8l0,0C37.7,6.1,31,3.4,23.7,4.1   c-2.6,0.2-5.1,1-7.4,2.2c-1.2,0.6-2.4,1.3-3.4,2.1c-0.7,0.5-0.8,1.6-0.2,2.3l2.1,2.1c0.5,0.5,1.3,0.6,1.9,0.2   c1.2-0.8,2.5-1.5,3.9-2.1c0.6-0.2,1.3-0.4,2-0.6c6.3-1.2,12.3,1.3,15.7,5.4c1.2,1.4,0.3,2.3-0.7,2.3h-7c-0.8,0-1.6,0.7-1.6,1.5v3   c0,0.8,0.8,1.5,1.6,1.5h18.2c0.7,0,1.2-0.6,1.2-1.3V3.5C50,2.7,49.3,2,48.5,2z"/><path d="M39.4,37.4c-0.6-0.6-1.5-0.6-2.1,0c-1.6,1.6-3.6,2.9-5.8,3.7c-0.6,0.2-1.3,0.4-2,0.6   c-6.3,1.2-12.3-1.3-15.7-5.4c-1.2-1.4-0.3-2.3,0.7-2.3h7c0.8,0,1.5-0.7,1.5-1.5v-3c0-0.8-0.7-1.5-1.5-1.5H3.3C2.6,28,2,28.6,2,29.3   v19.2C2,49.3,2.7,50,3.5,50h3C7.3,50,8,49.3,8,48.5v-7c0-0.9,1-1.5,1.6-0.8l0,0c4.6,5.2,11.4,7.9,18.7,7.2c2.6-0.2,5.1-1,7.4-2.2   c2.2-1.1,4.1-2.5,5.7-4.1c0.6-0.6,0.6-1.6,0-2.1L39.4,37.4z" stroke-width="1" stroke="black"/>  </svg>'}'), auto;

}
#pointer-capture {
    width: 100%;
    height: 100%;
}
`;let vi=class extends Ce{constructor(){super(),this.originX=null,this.originY=null,this.captureX=0,this.captureY=0,this.captureCenterX=0,this.captureCenterY=0,this.rotating=!1,this.deltaRadians=0}connectedCallback(){super.connectedCallback()}getDetail(e){var t,n;let i=e.clientX,r=e.clientY,s=null!=(t=this.originX)?t:this.captureCenterX,o=null!=(n=this.originY)?n:this.captureCenterY;return this.deltaRadians=function(e,t,n,i){const r=e*n+t*i,s=e*i-t*n;return Math.atan2(s,r)}(this.captureX-s,this.captureY-o,i-s,r-o),{radians:this.deltaRadians,originClientX:s,originClientY:o,captureClientX:this.captureX,captureClientY:this.captureY}}handle_onpointerdown(e){if(e.target){const t=e.target;t.onpointermove=this.handle_onpointermove.bind(this),t.setPointerCapture(e.pointerId),this.captureX=e.clientX,this.captureY=e.clientY,this.deltaRadians=0,this.captureCenterX=this.clientLeft+this.clientWidth/2,this.captureCenterY=this.clientTop+this.clientHeight/2,this.rotating=!0;const n=new CustomEvent(vi.EVENTS.rotationstart,this.createRotationEvent(e,this.getDetail(e)));this.dispatchEvent(n),e.stopPropagation(),e.preventDefault()}}handle_onpointermove(e){if(this.rotating){const t=new CustomEvent(vi.EVENTS.rotating,this.createRotationEvent(e,this.getDetail(e)));this.dispatchEvent(t),e.stopPropagation(),e.preventDefault()}}handle_onpointerup(e){if(e.target&&this.rotating){const t=e.target;t.onpointermove=null,this.rotating=!1;const n=new CustomEvent(vi.EVENTS.rotationend,this.createRotationEvent(e,this.getDetail(e)));this.dispatchEvent(n),t.releasePointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault()}}handle_onpointerleave(e){if(this.rotating&&e.target){let t=e.target;t.onpointermove=null,this.rotating=!1;const n=new CustomEvent(vi.EVENTS.rotationcanceled,this.createRotationEvent(e,this.getDetail(e)));this.dispatchEvent(n),t.releasePointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault()}}cancelRotate(){let e=new PointerEvent("pointercancel",{});this.handle_onpointerleave(e)}createRotationEvent(e,t){return n=pi({},e),i={bubbles:!0,composed:!0,detail:pi({altKey:e.altKey,metaKey:e.metaKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey},t)},oi(n,li(i));var n,i}};function bi(e,t,n){var i;let r=document.createElementNS(e,t);return n.parentElement&&(null==(i=n.parentElement)||i.replaceChild(r,n)),r.appendChild(n),r}function yi(e){if(e instanceof HTMLElement)return e;if(e instanceof SVGElement)return e instanceof SVGSVGElement?e:bi("http://www.w3.org/2000/svg","svg",e);if(e instanceof MathMLElement)return"MATH"!=e.tagName?bi("http://www.w3.org/1998/Math/MathML","math",e):e;throw new Error("Not implemented")}vi.EVENTS={rotationstart:"rotationstart",rotating:"rotating",rotationend:"rotationend",rotationcanceled:"rotationcanceled"},gi([j({converter:F})],vi.prototype,"originX",2),gi([j({converter:F})],vi.prototype,"originY",2),vi=gi([De({name:"mmr-rotation-handle",template:fi,styles:mi})],vi);const wi=new class{canConvert(e,t){return e instanceof HTMLElement||e instanceof SVGElement||e instanceof MathMLElement}canConvertSequence(e,t){return e.every((e=>this.canConvert(e)))}convert(e){return yi(e)}convertSequence(e){return e.map((e=>yi(e)))}},Ei=new class{canConvert(e,t){return e instanceof HTMLTableRowElement}canConvertSequence(e,t){return e.every((e=>this.canConvert(e)))}convert(e){if(e instanceof HTMLTableRowElement)return e}convertSequence(e){return e.map((e=>this.convert(e))).filter((e=>null!=e))}};function Si(e){let t=window.getComputedStyle(e);var n=e.getBoundingClientRect();let i=xi(t.columnGap),r=xi(t.rowGap);return{columns:t.gridTemplateColumns.split(" ").map((e=>parseFloat(e))),rows:t.gridTemplateRows.split(" ").map((e=>parseFloat(e))),columnGap:i,rowGap:r,bounds:{clientX:n.x+xi(t.paddingLeft),clientY:n.y+xi(t.paddingTop),clientWidth:n.width-2*xi(t.paddingLeft),clientHeight:n.height-2*xi(t.paddingTop)}}}function xi(e){let t=parseFloat(e);return!Number.isNaN(t)&&Number.isFinite(t)||(t=0),t}function Ti(e,t,n,i,r,s){let o=0,a=i.length,l=0,d=0;const h=n/2;for(let s=0;s<i.length;s++){if(d<e)o=s,l=d;else if((r?e:l)+t<d){a=s;break}d+=i[s]+(0==s||s==i.length-1?h:n)}if(!s){let n=(r?e:l)+t-d;n>=0?a+=i[i.length-1]>0?Math.ceil(n/i[i.length-1]):1:e>d&&(o+=1,a+=1)}return[o+1,a+1]}const Ci=new class{toView(e){return e.join(",")}fromView(e){return Array.isArray(e)?e:"string"==typeof e?e.split(",").map((e=>e)):[]}};var Di=Object.defineProperty,ki=Object.getOwnPropertyDescriptor,Mi=Object.getOwnPropertySymbols,$i=Object.prototype.hasOwnProperty,Li=Object.prototype.propertyIsEnumerable,Ai=(e,t,n)=>t in e?Di(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Bi=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?ki(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Di(t,n,s),s},Oi=(e,t,n)=>new Promise(((i,r)=>{var s=e=>{try{a(n.next(e))}catch(e){r(e)}},o=e=>{try{a(n.throw(e))}catch(e){r(e)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())}));const Pi="--padding",Ri="--grid-gap",Ni="--grid-column-width",Ii="--grid-column-height",zi="--cell-padding",_i="--cell-grid-gap",Hi="--cell-dragover-background";let Fi=class extends Ce{constructor(){super(),this.lockHandleCallback=this.handleLockButton.bind(this),this.slotChangeTimeout=null,this.addEventListener("mouseenter",this.handleMouseEnter),this.addEventListener("mouseleave",this.handleMouseLeave),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.slotSizeObsever=new ResizeObserver((e=>{this.recalculateGrid(),this.refreshOverlayElements()})),this.addEventListener(Nt.EVENTS.resizing,(e=>{this.recalculateGrid(),this.refreshOverlayElements()})),this.internals=this.attachInternals()}handleMouseEnter(e){this.refreshOverlayElements()}refreshOverlayElements(){var e,t;if(this.shadowRoot){let n=zn(this.slotElement).assignedItems;if(n.length>1){let i=Array.from(this.shadowRoot.querySelectorAll(".overlay"));const r=document.createElement("template");if(r.innerHTML='<div class="overlay"><button title="Lock in place"></button></div>',i.length!=n.length){for(;i.length<n.length;){let t=null==(e=r.content.firstElementChild)?void 0:e.cloneNode(!0);this.shadowRoot.append(t),i.push(t),t.querySelector("button").addEventListener("click",this.lockHandleCallback)}for(;i.length>n.length;)null==(t=i.pop())||t.remove()}let s=this.getBoundingClientRect();for(let e=0;e<n.length;e++){let t=n[e],r=i[e],o=t.getBoundingClientRect(),a=r.querySelector("button"),l=""!=t.style.gridRowStart||""!=t.style.gridColumnStart;a.innerText=l?"":"";let d=o.left-s.left,h=o.top-s.top;a.buttonTargetElement=t,r.style.width=`${o.width}px`,r.style.height=`${o.height}px`,r.style.left=`${d}px`,r.style.top=`${h}px`}}}}handleLockButton(e){let t=e.target,n=t.buttonTargetElement;""!=n.style.gridRowStart||""!=n.style.gridColumnStart?(t.innerText="",this.unlockElement(n)):(t.innerText="",this.lockElement(n))}handleMouseLeave(e){this.removeOverlayElements()}removeOverlayElements(){if(this.shadowRoot)for(let e of this.shadowRoot.querySelectorAll(".overlay"))e.remove()}lockElement(e){let t=e.getBoundingClientRect(),n=Si(this.slotElement),i=0,r=0,s=0,o=0;for(;s<n.columns.length&&(i+=n.columns[s],!(n.bounds.clientX+i>=t.left));s++)i+=n.columnGap;for(;o<n.rows.length&&(r+=n.rows[o],!(n.bounds.clientY+r>=t.top));o++)r+=n.rowGap;e.style.gridColumnStart=(s+1).toString(),e.style.gridRowStart=(o+1).toString()}unlockElement(e){var t;let n=zn(this.slotElement).assignedItems.filter((t=>""==t.style.gridRowStart&&""==t.style.gridColumnStart&&t!=e)),i=e.getBoundingClientRect(),r=i.left+i.width,s=i.top+i.height,o=n.map(((e,t)=>{let n=e.getBoundingClientRect();return{element:e,bbox:n}})).filter((e=>e.bbox.left>=r&&e.bbox.top>=i.top||e.bbox.top>i.top)),a=o.map((e=>{return t=e.bbox,Math.abs(t.left+t.width-r)+Math.abs(t.top-s);var t})).reduce(((e,t,n,i)=>t<i[e]?n:e),-1);a<0&&(a=0);let l=null==(t=o[a])?void 0:t.element;l?l.before(e):this.parentGrid.append(e),e.style.gridColumnStart="",e.style.gridRowStart=""}recalculateGrid(){let{minColumnWidth:e,minRowHeight:t,rowGap:n,columnGap:i}=this.getGridParameters(),r=zn(this.slotElement).assignedItems;if(r.length>1)for(let s of r){let r=s.getBoundingClientRect(),o=Gi(r.width,e,i),a=Gi(r.height,t,n);s.style.gridColumnEnd=`span ${o}`,s.style.gridRowEnd=`span ${a}`}else r[0].style.gridColumnEnd="",r[0].style.gridRowEnd="",r[0].style.gridColumnStart="",r[0].style.gridRowStart=""}slotChanged(e){null==this.slotChangeTimeout&&(this.slotChangeTimeout=setTimeout((()=>{this.slotChangeTimeout=null;let e=zn(this.slotElement).assignedItems;if(e.length<2){this.slotElement.classList.add("one-element");for(let t of e)t.style.gridColumnEnd="",t.style.gridColumnStart="",t.style.gridRowEnd="",t.style.gridRowStart=""}else this.slotElement.classList.remove("one-element");this.refreshOverlayElements()}),0))}handleDragStart(e){let t=e.composedPath()[0];if(t instanceof HTMLElement){let n=t,i=zn(this.slotElement).assignedItems.includes(t);(i||t==this)&&this.internals.states.add("dragging"),i&&(this.parentGrid.dragSource.handleDragStart(e,this,n,t,this.slotElement),e.stopPropagation())}}getDynamicGridSlot(){return this.slotElement.assignedElements()[0]}handleDragEnd(e){this.internals.states.delete("dragging")}handleDragEnter(e){this.parentGrid.dropTarget.handleDragEnter(e,this),this.parentGrid.dispatchEvent(new CustomEvent("dragleave")),e.stopPropagation()}handleDragOver(e){this.parentGrid.dropTarget.handleDragOver(e,this)}handleDragLeave(e){this.parentGrid.dropTarget.handleDragLeave(e,this)}handleDrop(e){return Oi(this,null,(function*(){let t=!1,n=0,i=0;yield this.parentGrid.dropTarget.handleDrop(e,this,{before:()=>{let t=zn(this.slotElement).assignedItems,n=this.getDynamicGridSlot(),{minRowHeight:i,minColumnWidth:r,rowGap:s,columnGap:o}=this.getGridParameters();if(1==t.length){let e=t[0],n=e.getBoundingClientRect(),a=Gi(n.width,r,o),l=Gi(n.height,i,s);e.style.gridColumnEnd=`span ${a}`,e.style.gridRowEnd=`span ${l}`,e.style.gridColumnStart="1",e.style.gridRowStart="1"}let{rowIndex:a,columnIndex:l,gridState:d}=this.calculatePlaceholderCell(e.clientX,e.clientY);return{slot:n,slotElements:t,minRowHeight:i,minColumnWidth:r,rowGap:s,columnGap:o,rowIndex:a,columnIndex:l,gridState:d}},resolveDrop:(e,{slot:r,gridState:s,columnIndex:o,rowIndex:a,minColumnWidth:l,minRowHeight:d})=>{let h="string"==e.kind;if(t&&h)return!1;let c=!1;if(Array.isArray(e.data))for(let t of e.data)({gridColumnOffset:n,gridRowOffset:i}=this.appendDropToGrid(t,r,s,c?void 0:o,c?void 0:a,l,d,n,i)),c=!0;else({gridColumnOffset:n,gridRowOffset:i}=this.appendDropToGrid(e.data,r,s,c?void 0:o,c?void 0:a,l,d,n,i)),c=!0;return t=t||c,!t||!h},after:({slotElements:e})=>{if(i>0)for(let t of e)t.style.gridRowStart&&(t.style.gridRowStart=(parseInt(t.style.gridRowStart)+i).toString());if(n>0)for(let t of e)t.style.gridColumnStart&&(t.style.gridColumnStart=(parseInt(t.style.gridColumnStart)+n).toString())}})}))}appendDropToGrid(e,t,n,i,r,s,o,a,l){let d=e.getBoundingClientRect();e.slot=t.name;let h,c=null!=i?i:0;i?h=ji(c-1,n.columns,n.columnGap,d.width,s):(h=Gi(d.width,s,n.columnGap),c+=1+a,a=Math.max(a,h));let u,p=null!=r?r:0;return r?u=ji(r-1,n.rows,n.rowGap,d.height,o):(u=Gi(d.height,o,n.rowGap),p+=1+l,l=Math.max(l,u)),e.style.gridColumnStart=void 0===i?"":c.toString(),e.style.gridRowStart=void 0===r?"":p.toString(),d.height>0?e.style.gridRowEnd=`span ${u.toString()}`:e.style.gridRowEnd="",d.width>0?e.style.gridColumnEnd=`span ${h.toString()}`:e.style.gridColumnEnd="",this.parentGrid.append(e),e.setAttribute("draggable","true"),{gridColumnOffset:a,gridRowOffset:l}}getGridParameters(){let e=window.getComputedStyle(this.slotElement),t=parseFloat(e.getPropertyValue(Ni));return{minRowHeight:parseFloat(e.getPropertyValue(Ii)),minColumnWidth:t,columnGap:parseFloat(e.columnGap),rowGap:parseFloat(e.rowGap)}}dropPlaceholderIsVisible(){return this.parentGrid.dropPlaceholderIsVisible()}showDropPlaceholder(e){this.internals.states.add("dragover"),this.parentGrid.showDropPlaceholder(e),this.parentGrid.placeholder.classList.add("dragging")}updateDropPlaceholder(e){this.parentGrid.updateDropPlaceholder(e)}hideDropPlaceholder(e){this.internals.states.delete("dragover"),this.parentGrid.placeholder.classList.remove("dragging")}calculatePlaceholderCell(e,t){let n=Si(this.slotElement),i=this.parentGrid.placeholder.style.width,r=this.parentGrid.placeholder.style.height,s=parseFloat(i),o=parseFloat(r);return((e,t)=>{for(var n in t||(t={}))$i.call(t,n)&&Ai(e,n,t[n]);if(Mi)for(var n of Mi(t))Li.call(t,n)&&Ai(e,n,t[n]);return e})({gridState:n},function(e,t,n,i,r){let s,o,a=e.clientX,l=e.clientY,d=function(e,t,n,i,r){const[s,o]=Ti(e.clientX-t.bounds.clientX,e.clientWidth,t.columnGap,t.columns,n,r),[a,l]=Ti(e.clientY-t.bounds.clientY,e.clientHeight,t.rowGap,t.rows,n,i);return[a,s,l,o]}(e,t,n,i,r);return s=l<t.bounds.clientY?0:l>t.bounds.clientY+t.bounds.clientHeight?t.rows.length+1:d[0],o=a<t.bounds.clientX?0:a>t.bounds.clientX+t.bounds.clientWidth?t.columns.length+1:d[1],{rowIndex:s,columnIndex:o}}({clientX:e+=this.scrollLeft,clientY:t+=this.scrollTop,clientWidth:s,clientHeight:o},n,!1,!1,!1))}connectedCallback(){if(super.connectedCallback(),"complete"==document.readyState)this.slotSizeObsever.observe(this);else{const e=this;document.addEventListener("load",(function(t){e.slotSizeObsever.observe(e)}),{once:!0})}}disconnectedCallback(){this.slotSizeObsever.disconnect()}};Fi=Bi([De({name:"mmr-dynamic-grid-cell",template:ut`
    <slot part="content" ${gt("slotElement")} @slotchange="${(e,t)=>e.slotChanged(t.event)}"></slot>
    `,styles:xt`
:host {
    ${Pi}: 10px;
    ${Ri}: 10px;
    ${Ni}: 10px;
    ${Ii}: 10px;
}

slot:hover {
    background: rgba(0,0,0,0.05)
}

slot {
    grid-auto-flow: dense;
    grid-template-columns: repeat(auto-fit,  minmax(var(${Ni}),auto));
    grid-template-rows: repeat(auto-fit,  minmax(var(${Ii}),auto));
    display: grid;
    padding: var(${Pi});
    grid-gap: var(${Ri});
}

slot.one-element{
    grid-template-columns: 1fr;
    grid-template-rows: 1fr;
}

:host {
    position: relative;
}

.overlay {
    position: absolute;
    display: none;
    pointer-events: none;
}

.overlay > button {
    pointer-events: all;
    font-size: 16px;
}

.overlay::before {
    content: 
}

:host(:hover) .overlay {
    display: block
}
:host(:hover) .overlay > button:not(:hover) {
    animation: slideaway 500ms forwards 2000ms;
}

@keyframes slideaway {
  from { }
  to { transform: translate(-10px, -10px); opacity: 0; pointer-events:none}
}
`})],Fi);let Vi=class extends Ce{constructor(){super(),this.dragSource=Kn,this.order=[],this.slotIndex=1,this.showPlaceholderTimeout=null,this.lastClientX=-1,this.lastClientY=-1,this.taskNotQueued=!0,this.hidePlaceholderTimeout=null,this.dropTarget=new qn(Nn,Hn,wi),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.internals=this.attachInternals(),this.childrenObserver=new MutationObserver((e=>{for(let t of e)if(t.target instanceof Vi)for(let e of t.addedNodes)t.target.appendNodeInSlot(e)})),this.gridObserver=new MutationObserver((e=>{let t=!1,n=!1,i=!1,r=!1;for(let s of e)if(s.target instanceof HTMLElement){for(let e of s.removedNodes)if(e instanceof Fi){if(e.part.contains("first")){t=!0;break}if(e.part.contains("last")){r=!0;break}}for(let e of s.addedNodes)e instanceof Fi&&(null==e.previousElementSibling&&(t=!0,n=!0),null==e.nextElementSibling&&(r=!0,i=!0))}(t||r)&&this.updateFirstLastCellpart(t,r,n,i),this.order=Array.from(this.grid.querySelectorAll("slot")).map((e=>e.name))}))}updateFirstLastCellpart(e,t,n,i){let r=Array.from(this.grid.childNodes);if(r.length>0&&(e&&r[0].part.add("first"),t&&r[r.length-1].part.add("last"),n||i)){let e=r.slice(1,r.length-1);for(let t of e)t.part.remove("first"),t.part.remove("last")}}orderChanged(e,t){(null==e||null==t||(null==e?void 0:e.length)!=(null==t?void 0:t.length)||e.some(((e,n)=>e!=t[n])))&&this.sortSlotsByOrder()}appendNodeInSlot(e){if(e instanceof Element&&(""==e.slot&&(e.slot=this.generateSlotName()),null==this.grid.querySelector(`slot[name="${e.slot}"]`))){let{cell:t}=this.createSlot(e.slot);this.grid.append(t)}}createSlot(e){let t=document.createElement("slot");t.addEventListener("slotchange",this.slotChanged),t.name=e;let n=document.createElement("mmr-dynamic-grid-cell");return n.appendChild(t),n.setAttribute("draggable","true"),n.parentGrid=this,n.part.add("cell"),{cell:n,slot:t}}slotChanged(e){0==this.assignedElements().length&&this.parentElement instanceof Fi&&this.parentElement.remove()}generateSlotName(){let e,t=Array.from(this.grid.querySelectorAll("slot")),n=new Set(t.map((e=>e.name)));do{e="slot"+this.slotIndex++}while(n.has(e));return e}dropPlaceholderIsVisible(){return this.internals.states.has("dragover")||this.placeholder.classList.contains("dragging")}showDropPlaceholder(e){null!=this.hidePlaceholderTimeout&&clearTimeout(this.hidePlaceholderTimeout),this.hidePlaceholderTimeout=null,null==this.showPlaceholderTimeout&&(this.showPlaceholderTimeout=setTimeout((()=>{this.showPlaceholderTimeout=null,this.internals.states.add("dragover"),this.updateDropPlaceholder(e)}),20)),this.setPlaceholderSizeToContent(e,this.placeholder)}updateDropPlaceholder(e){this.dropPlaceholderIsVisible()&&this.lastClientX!=e.clientX&&this.lastClientY!=e.clientY&&this.taskNotQueued&&(this.taskNotQueued=!1,queueMicrotask((()=>this.paintPlaceholder(e.clientX,e.clientY,e.currentTarget))))}paintPlaceholder(e,t,n){this.taskNotQueued=!0,this.lastClientX=e,this.lastClientY=t;let{previousElement:i,nextElement:r,hoveredElement:s,flowDirectionX:o}=Jn(this.grid,this.getCells(),e,t);s&&n==s?this.showGridCellPlaceholder(s,e,t):null==s?this.showDynamicGridPlaceholder(i,r,o):this.removePlaceholder()}getCells(){return Array.from(this.grid.childNodes)}showGridCellPlaceholder(e,t,n){let i,r,s=window.getComputedStyle(e.slotElement),o=parseFloat(s.paddingLeft),a=parseFloat(s.paddingRight),l=parseFloat(s.paddingTop),d=parseFloat(s.paddingBottom),h=this.placeholder.offsetWidth,c=this.placeholder.offsetHeight,u=e.getBoundingClientRect(),p=e.getGridParameters(),g=t-u.left,f=n-u.top;if(g<o)i=-h+p.columnGap;else{let e=p.minColumnWidth+p.columnGap;i=Math.floor((g-o)/e)*e+o,g>=Math.floor(u.width-a-p.columnGap)&&(i+=p.columnGap)}if(f<l)r=-c+l;else{let e=p.minRowHeight+p.rowGap;r=Math.floor((f-l)/e)*e+l,f>=Math.floor(u.height-d-p.rowGap)&&(r+=p.rowGap)}i+=e.offsetLeft,r+=e.offsetTop,this.placeholder.style.left=`${i}px`,this.placeholder.style.top=`${r}px`}getDragContensSize(){var e,t;let n=0,i=0,r=null==(e=this.dragSource.dataTransferSource.internalDataTransfer)?void 0:e.content;if(r)if(r instanceof HTMLElement)n=r.offsetWidth,i=r.offsetHeight;else{let e=null==(t=this.dragSource.dataTransferSource.internalDataTransfer)?void 0:t.source;e&&(n=e.offsetWidth,i=e.offsetHeight)}return{width:n,height:i}}showDynamicGridPlaceholder(e,t,n){var i;let r=null==(i=this.dragSource.dataTransferSource.internalDataTransfer)?void 0:i.source,{left:s,top:o,width:a,height:l}=function(e,t,n,i,r){let s,o,a,l;if(!r||r!=t&&r!=n){let r=0,d=e.offsetWidth,h=0,c=e.offsetHeight;t&&n?(i?n.offsetLeft<=t.offsetLeft:n.offsetTop<=t.offsetTop)?i?(r=0,d=n.offsetLeft,h=n.offsetTop,c=n.offsetTop+n.offsetHeight):(h=0,c=n.offsetTop,r=n.offsetLeft,d=n.offsetLeft+n.offsetWidth):i?(r=t.offsetLeft+t.offsetWidth,d=n.offsetLeft,h=Math.min(t.offsetTop,n.offsetTop),c=Math.min(t.offsetTop+t.offsetHeight,n.offsetTop+n.offsetHeight)):(h=t.offsetTop+t.offsetHeight,c=n.offsetTop,r=Math.min(t.offsetLeft,n.offsetLeft),d=Math.min(t.offsetLeft+t.offsetWidth,n.offsetLeft+n.offsetWidth)):t?i?(r=t.offsetLeft+t.offsetWidth,d=e.offsetWidth,h=t.offsetTop,c=t.offsetTop+t.offsetHeight):(h=t.offsetTop+t.offsetHeight,c=e.offsetHeight,r=t.offsetLeft,d=t.offsetLeft+t.offsetWidth):n&&(i?(r=0,h=n.offsetTop,d=n.offsetLeft,c=n.offsetHeight):(r=n.offsetLeft,h=0,d=n.offsetWidth,c=n.offsetTop)),s=r,o=h,a=Math.max(5,d-r),l=Math.max(5,c-h)}else s=r.offsetLeft,o=r.offsetTop,a=r.offsetWidth,l=r.offsetHeight;return{left:s,top:o,width:a,height:l}}(this,e,t,n,r);this.placeholder.style.left=`${s}px`,this.placeholder.style.top=`${o}px`,this.placeholder.style.width=`${a}px`,this.placeholder.style.height=`${l}px`}hideDropPlaceholder(e){this.removePlaceholder()}removePlaceholder(){this.lastClientX=-1,this.lastClientY=-1,null!=this.showPlaceholderTimeout&&clearTimeout(this.showPlaceholderTimeout),this.showPlaceholderTimeout=null,this.hidePlaceholderTimeout=null,this.internals.states.delete("dragover")}handleDragEnter(e){this.dropTarget.handleDragEnter(e,this)}handleDragOver(e){this.dropTarget.handleDragOver(e,this)}handleDragLeave(e){this.dropTarget.handleDragLeave(e,this)}handleDrop(e){return Oi(this,null,(function*(){let t=!1;yield this.dropTarget.handleDrop(e,this,{resolveDrop:n=>{let{previousElement:i,nextElement:r,reversedFlow:s}=Jn(this.grid,this.getCells(),e.clientX,e.clientY),o=s?r:i,a="string"==n.kind;return!(a&&t||(t=this.insertItem(n.data,o)||t,t&&a))}})}))}insertItem(e,t){const n=this;function i(e){t?t.after(e):n.grid.prepend(e)}let r;if(e instanceof HTMLSlotElement&&this.grid.contains(e))r=e,r.parentElement instanceof Fi&&i(r.parentElement);else{let t=this.generateSlotName(),n=this.createSlot(t);if(r=n.slot,i(n.cell),Array.isArray(e))for(let n of e)n.slot=t,this.append(n);else e.slot=t,this.append(e)}return!0}handleDragStart(e){let t=e.composedPath()[0];if(t instanceof Fi){let n=t.querySelector("slot");n&&this.dragSource.handleDragStart(e,this,n,t,t)}}handleDragEnd(e){this.dragSource.handleDragEnd(e,this)}connectedCallback(){super.connectedCallback(),this.sortSlotsByOrder(),this.childrenObserver.observe(this,{childList:!0,subtree:!1}),this.gridObserver.observe(this.grid,{subtree:!1,childList:!0});for(let e of this.childNodes)this.appendNodeInSlot(e);this.updateFirstLastCellpart(!0,!0,!0,!0)}sortSlotsByOrder(){if(this.order&&this.order.length>0&&this.grid){let e;for(let t of this.order){let n=this.grid.querySelector(`slot[name="${t}"]`);null==n&&(n=this.createSlot(t).slot),n.parentElement&&((null==e?void 0:e.parentElement)?e.parentElement.nextElementSibling!=n.parentElement&&e.parentElement.after(n.parentElement):n.parentElement!=this.grid.firstElementChild&&this.grid.insertBefore(n.parentElement,this.grid.firstElementChild),e=n)}}}disconnectedCallback(){this.gridObserver.disconnect(),this.childrenObserver.disconnect()}setPlaceholderSizeToContent(e,t){var n;if(e.dataTransfer&&this.dragSource.dataTransferSource.hasData()){const{width:e,height:i}=this.getDragContensSize();(null==(n=this.dragSource.dataTransferSource.internalDataTransfer)?void 0:n.source)&&(t.style.width=`${Math.max(10,e)}px`,t.style.height=`${Math.max(10,i)}px`)}}};function ji(e,t,n,i,r){let s=0,o=0;for(let r=e;r<t.length&&s<i;r++)s+=t[r],r!=e&&(s+=n),o++;return s<i&&(o+=Gi(i-s,r,n)),o}function Gi(e,t,n){let i=Math.floor(e/(t+n))+1;return(i-1)*(t+n)+t>e&&i--,i}Bi([j({converter:Ci})],Vi.prototype,"order",2),Vi=Bi([De({name:"mmr-dynamic-grid",template:ut`
<div id="grid" ${gt("grid")} part="grid"></div>
<div id="placeholder" ${gt("placeholder")} part="placeholder"></div>
    `,styles:[xt`
:host {
    display: block;
}
`,xt`
:host {
    ${zi}: 10px;
    ${_i}: 10px;
    ${Hi}: rgba(0,0,0,0.1);
}

mmr-dynamic-grid-cell {
    ${Pi}: var(${zi});
    ${Ri}: var(${_i});
}

mmr-dynamic-grid-cell:state(dragover) slot::slotted(*){
    background: var(${Hi})
}

mmr-dynamic-grid-cell {
    overflow: auto;
}

#grid {
    max-width: inherit;
    max-height: inherit;
    min-width: inherit;
    min-height: inherit;
}

#grid {
    display: flex;
    flex-flow: row wrap;
    justify-content: space-between;
    align-content: flex-start;
    column-gap: 10px;
    row-gap: 0px;
}

#grid > * {
    flex: 0 1 auto;
}
`,xt`
:host {
    position: relative;
}

#placeholder {
    position: absolute;
    visibility: hidden;
    pointer-events: none;
    background: rgba(0,0, 255, 0.3);
}

:host(:state(dragover)) #placeholder,
#placeholder.dragging {
    visibility: visible;
}`]})],Vi);Object.defineProperty,Object.getOwnPropertyDescriptor;let Wi=class extends Ce{constructor(){super(),this.dragSource=Kn,this.dropTarget=new qn(Nn,Hn,Ei),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.internals=this.attachInternals(),this.observer=new MutationObserver((e=>{var t,n,i;for(let r of e)if(r.addedNodes.length>0)for(let e of r.addedNodes)e instanceof HTMLTableRowElement&&"TBODY"==(null==(t=e.parentElement)?void 0:t.tagName)&&(null==(i=null==(n=e.parentElement)?void 0:n.parentElement)?void 0:i.parentElement)==this&&(e.hasAttribute("draggable")||e.setAttribute("draggable","true"))}))}handleDragStart(e){this.dragSource.handleDragStart(e,this)}handleDragEnd(e){this.hideDropPlaceholder(e),this.internals.states.delete("dragging")}handleDragEnter(e){this.dropTarget.handleDragEnter(e,this)}handleDragOver(e){this.dropTarget.handleDragOver(e,this)}handleDragLeave(e){this.dropTarget.handleDragLeave(e,this)}handleDrop(e){return t=this,n=function*(){let t=this.getDropTarget(e);if(t){let n=!1;yield this.dropTarget.handleDrop(e,this,{resolveDrop:e=>{let i="string"==e.kind;if(i&&n)return!1;if(Array.isArray(e.data))for(let i of e.data)n=this.insertRow(i,t)||n;else n=this.insertRow(e.data,t)||n;return!n||!i}})}},new Promise(((e,i)=>{var r=e=>{try{o(n.next(e))}catch(e){i(e)}},s=e=>{try{o(n.throw(e))}catch(e){i(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);o((n=n.apply(t,null)).next())}));var t,n}insertRow(e,t){if(!(e instanceof HTMLTableRowElement))return!1;if(t instanceof HTMLTableSectionElement)return t.append(e),e.slot="",!0;if(e==t)return!1;if(e.childNodes.length!=t.childNodes.length)return!1;let n,i=Array.from(e.querySelectorAll("td")),r=Array.from(t.querySelectorAll("td"));for(let e=0;e<i.length;e++){let t=i[e],n=r[e];if(t.colSpan!=n.colSpan)return!1}if(null==t.nextElementSibling?n=!0:null==t.previousElementSibling&&(n=!1),void 0===n&&e.parentElement==t.parentElement){let i=e.nextSibling;for(;i!=t&&null!=i;)i=i.nextSibling;n=i==t}return n?t.after(e):t.before(e),e.slot="",!0}dropPlaceholderIsVisible(){return this.internals.states.has("dragover")}showDropPlaceholder(e){this.internals.states.add("dragover"),this.updateDropPlaceholder(e)}updateDropPlaceholder(e){let t=this.getDropTarget(e);t&&(this.placeholder.style.left=`${t.offsetLeft}px`,this.placeholder.style.top=`${t.offsetTop}px`,this.placeholder.style.width=`${Math.max(10,t.offsetWidth)}px`,this.placeholder.style.height=`${Math.max(10,t.offsetHeight)}px`)}getDropTarget(e){let t,n=this.getTable(),{previousElement:i,nextElement:r,hoveredElement:s,flowDirectionX:o}=Jn(n,this.getRows(),e.clientX,e.clientY);if(t=s,!t){let{previousElement:i,nextElement:r,flowDirectionX:s}=Jn(n,Array.from(n.tBodies),e.clientX,e.clientY);t=null!=r?r:i}return t}getRows(){let e=[];for(let t of this.getTable().tBodies)for(let n of t.rows)e.push(n);return e}getTable(){return this.querySelector("table")}hideDropPlaceholder(e){this.internals.states.delete("dragover")}connectedCallback(){super.connectedCallback();for(let e of this.querySelectorAll("tbody tr"))e.setAttribute("draggable","true");this.observer.observe(this,{subtree:!0,childList:!0})}disconnectedCallback(){this.observer.disconnect()}};Wi=((e,t)=>{for(var n,i=t,r=e.length-1;r>=0;r--)(n=e[r])&&(i=n(i)||i);return i})([De({name:"mmr-table",template:ut`
    <slot></slot>
    <div id="placeholder" ${gt("placeholder")} part="placeholder"></div>
    `,styles:xt`
:host {
    display: block;
    position: relative;
}

#placeholder {
    position: absolute;
    display: none;
    pointer-events: none;
    background: rgba(0,0, 255, 0.3);
}

:host(:state(dragover)) #placeholder,
#placeholder.dragging {
    display: block;
}
`})],Wi);class Xi extends pn{constructor(e,t="text"){super(pn.DEFAULT_MAX_BYTES,t),this.mimeType=e}canLoad(e){return"Files"==e||e.startsWith(this.mimeType)}loadFromString(e,t,n){if(this.canLoad(t))return e}}Object.defineProperty,Object.getOwnPropertyDescriptor;const Ui=new nn([{type:"both",loader:new Xi("text/uri-list")},{type:"both",loader:new Xi("text/x-moz-url-data")},{type:"both",loader:new Xi("image/svg+xml","text")},{type:"both",loader:new Xi("image/","dataurl")},{type:"both",loader:new Xi("application/pdf","dataurl")},{type:"both",loader:new Xi("audio/","dataurl")},{type:"both",loader:new Xi("video/","dataurl")}]);let Yi=class extends Ce{constructor(){super(),this.dragSource=Kn,this.dropTarget=new Yn(Ui),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.internals=this.attachInternals()}static get observedAttributes(){return["src","type"]}get src(){if(this.firstElementChild){let e=this.firstElementChild.src;return""==e?null:e}let e=this.getAttribute("src");return""==e?null:e}set src(e){let t;this.firstElementChild?t=this.firstElementChild:e&&(t=this.ensureEmbedableExists(e)),t?(e?t.src=e:t.remove(),this.removeAttribute("src")):this.setAttributeToProp(e,"src")}setAttributeToProp(e,t){e?this.getAttribute(t)!=e&&this.setAttribute(t,e):this.removeAttribute(t)}get type(){if(this.firstElementChild){let e=this.firstElementChild;if(e instanceof HTMLEmbedElement){let t=e.type;return""==t?null:t}}return this.getAttribute("type")}set type(e){if(this.type==e)return;let t;this.firstElementChild&&(t=this.firstElementChild),t instanceof HTMLEmbedElement?(e?t.type=e:t.removeAttribute("type"),this.removeAttribute("type")):this.setAttributeToProp(e,"type")}ensureEmbedableExists(e){let t,n=this.firstElementChild;return this.isImageType(this.type)?(t=null!=n&&n instanceof HTMLImageElement?n:document.createElement("img"),t.setAttribute("src",e)):(t=null!=n&&n instanceof HTMLEmbedElement?n:document.createElement("embed"),this.type&&t.setAttribute("type",this.type),t.setAttribute("src",e),fetch(e,{method:"HEAD"}).then((n=>{var i;if(this.type=n.headers.get("content-type"),(null==(i=this.type)?void 0:i.startsWith("image/"))&&null!=t.parentElement&&this.src==e){let n=document.createElement("img");n.src=e,t.replaceWith(n)}}))),null==t.parentElement&&(this.append(t),n&&n.remove()),t}isImageType(e){return null!=e&&e.startsWith("image/")}attributeChangedCallback(e,t,n){"src"==e?this.src=n:"type"==e&&(this.type=n),this.updateView()}updateView(){if(null==this.src)for(let e of Array.from(this.childNodes))e.remove();else{let e=this.ensureEmbedableExists(this.src);e.style.height="",e.style.width="",requestAnimationFrame((()=>{var e,t;let n=this.firstElementChild;(n instanceof HTMLImageElement||(null==(e=n.type)?void 0:e.startsWith("video/"))||(null==(t=n.type)?void 0:t.startsWith("image/")))&&(n.width<n.height?n.style.height="100%":n.style.width="100%")}))}}handleDragStart(e){if(this.dragSource.handleDragStart(e,this),e.dataTransfer){let t=this.type,n=this.src;t&&n&&(e.dataTransfer.types.includes(t)||e.dataTransfer.setData(t,n))}}handleDragEnd(e){e.dataTransfer&&"move"==e.dataTransfer.dropEffect&&(this.src=null,this.type=""),this.hideDropPlaceholder(e),this.internals.states.delete("dragging"),e.stopPropagation()}handleDragEnter(e){return this.dropTarget.handleDragEnter(e,this)}handleDragOver(e){return this.dropTarget.handleDragOver(e,this)}handleDragLeave(e){return this.dropTarget.handleDragLeave(e,this)}handleDrop(e){return t=this,n=function*(){yield this.dropTarget.handleDrop(e,this,{resolveDrop:e=>{var t,n;if("internal"!=e.kind){let i,r=null==(t=null==e?void 0:e.mimeType)?void 0:t.mimeType;if(i=Array.isArray(e.data)?e.data[0]:e.data,URL.canParse(i)||i.startsWith("data:")||("image/svg+xml"==r&&(i=i.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"'),i=`base64,${btoa(i)}`),i=`data:${r};${i}`),i.startsWith("data:")){const e=5;r=i.substring(e,i.indexOf(";"))}this.type=null!=r?r:null,this.src=i,null==(n=this.firstElementChild)||n.setAttribute("draggable","true")}return!1}})},new Promise(((e,i)=>{var r=e=>{try{o(n.next(e))}catch(e){i(e)}},s=e=>{try{o(n.throw(e))}catch(e){i(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);o((n=n.apply(t,null)).next())}));var t,n}dropPlaceholderIsVisible(){return this.internals.states.has("dragover")}showDropPlaceholder(e){this.internals.states.add("dragover"),this.updateDropPlaceholder(e)}updateDropPlaceholder(e){}hideDropPlaceholder(e){this.internals.states.delete("dragover")}connectedCallback(){super.connectedCallback(),this.updateView()}};Yi=((e,t)=>{for(var n,i=t,r=e.length-1;r>=0;r--)(n=e[r])&&(i=n(i)||i);return i})([De({name:"mmr-embed",template:ut`<slot></slot>`,styles:xt`
:host {
    display: block;
    overflow: hidden;
    min-width: 50px;
    min-height: 50px;
}

:host(:state(dragover)) {
    background: rgba(0,0,255,0.3);
}

img,
embed,
::slotted(img),
::slotted(embed) {
    max-width: 100%;
    max-height: 100%;
}

embed:not([type^="image/"]),
embed:not([type^="video/"]),
::slotted(embed:not([type^="image/"])),
::slotted(embed:not([type^="video/"])) {
    width: 100%;
    height: 100%;
}
`})],Yi);const qi=new class{toView(e){return e.join(",")}fromView(e){return"string"==typeof e?e.split(",").map((e=>parseFloat(e))):[]}};var Ki=Object.defineProperty,Qi=Object.getOwnPropertyDescriptor,Zi=(e,t,n,i)=>{for(var r,s=i>1?void 0:i?Qi(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Ki(t,n,s),s};let Ji=class extends Ce{constructor(){super(),this.max=10,this.value=[],this.columns=null,this.nStates=0,this.addEventListener("keydown",this.onKeyDown,!0),this.templateObserver=new MutationObserver((()=>{this.updateView()}))}columnsChanged(e,t){this.updateColumns()}updateColumns(){this.isConnected&&(this.columns&&this.columns>0?(this.style.gridAutoFlow="",this.style.gridTemplateColumns=`repeat(${this.columns}, 1fr)`):(this.style.gridAutoFlow="column",this.style.gridTemplateColumns=""))}onKeyDown(e){var t;if("-"==e.key){if(e.ctrlKey){let e=null!=(t=this.columns)?t:1;if(e--,e>=1){let e=Si(this);this.max=Math.max(this.max-e.rows.length,1)}this.columns=Math.max(1,e)}else{let e=Math.max(1,this.max-1);null!=this.columns&&e<this.columns&&(this.columns=e>1?e:null),this.max=e}e.preventDefault()}else if("+"==e.key){if(e.ctrlKey){let e=Si(this);if(null==this.columns||1==e.rows.length){let e=this.max;1==this.max?(this.columns=2,this.max=4):(this.columns=e,this.max*=2)}else this.max+=e.rows.length,this.columns++}else this.max++;e.preventDefault()}}minChanged(e,t){this.updateView()}maxChanged(e,t){this.updateView()}valueChanged(e,t){this.updateView()}updateView(){if(this.isConnected&&this.shadowRoot){const e=this.getStateTemplates();if(this.nStates=e.length,this.nStates<1){if(this.shadowRoot)for(;this.shadowRoot.lastElementChild;)this.shadowRoot.removeChild(this.shadowRoot.lastElementChild);return}let t=this.nStates-1;this.value&&(t=Math.min(t,this.value.length));let n=Array.from(this.shadowRoot.childNodes);for(let i=0;i<this.max;i++){let r=n[i],s=0,o=i+1;if(this.value){for(let e=t;e>0;e--)if(this.value[e-1]>=o){s=e;break}t=s}let a=!0;if(r&&(a=r.getAttribute("data-state")!=s.toString()),a){let t=e[s].content.cloneNode(!0).firstElementChild;if(t||(t=document.createElement("span"),t.textContent="State 1"),!(t instanceof HTMLElement)){let e=document.createElement("div");e.append(t),t=e}t.setAttribute("data-state",s.toString()),t.setAttribute("part",`value-${i}`),t.addEventListener("click",this.onClick.bind(this)),r?(this.shadowRoot.insertBefore(t,r),r.remove()):this.shadowRoot.append(t),r=t}let l=o.toString();r.setAttribute("data-value",l),r.setAttribute("title",l)}for(let e=this.max;e<n.length;e++)n[e].remove()}}getStateTemplates(){return Array.from(this.querySelectorAll("template"))}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),this.updateColumns(),this.updateView(),this.templateObserver.observe(this,{childList:!0,subtree:!1})}disconnectedCallback(){super.disconnectedCallback(),this.templateObserver.disconnect()}onClick(e){let t,n=e.currentTarget,i=n.getAttribute("data-state"),r=parseInt(i);if(e.preventDefault(),this.nStates<3){let e=parseInt(n.getAttribute("data-value"));t=(r+1)%this.nStates,this.value[0]=0==t?e-1:e}else{let i=parseInt(n.getAttribute("data-value"));if(t=e.ctrlKey?r-1:r+1,t>=this.nStates){let e=this.value[r-1];t=this.value.findLastIndex(((t,n)=>t>e))+1}else t%=this.nStates,t<0&&(t+=this.nStates);if(t>=r)for(let e=r;e<t;e++)this.value[e]=i;else for(let e=t;e<r;e++)this.value[e]=i-1}this.setAttribute("value",qi.toView(this.value))}};Zi([j({converter:F})],Ji.prototype,"max",2),Zi([j({converter:qi})],Ji.prototype,"value",2),Zi([j({converter:F})],Ji.prototype,"columns",2),Ji=Zi([De({name:"mmr-state-counter",styles:xt`
:host {
    display: grid;
}

:host > * {
    display: inline-block;
    margin: auto
}
`})],Ji);Object.defineProperty,Object.getOwnPropertyDescriptor;let er=class extends Ce{constructor(){super(),this.dragSource=Kn,this.dropTarget=new qn(Nn,Hn,wi),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),this.addEventListener("dragstart",this.handleDragStart),this.addEventListener("dragend",this.handleDragEnd),this.internals=this.attachInternals()}handleDragStart(e){return this.dragSource.handleDragStart(e,this)}handleDragEnd(e){this.hideDropPlaceholder(e),this.internals.states.delete("dragging")}handleDragEnter(e){this.dropTarget.handleDragEnter(e,this)}handleDragOver(e){this.dropTarget.handleDragOver(e,this)}handleDragLeave(e){this.dropTarget.handleDragLeave(e,this)}handleDrop(e){return t=this,n=function*(){let t=this.getFocusedElement(e),n=!1;yield this.dropTarget.handleDrop(e,this,{resolveDrop:e=>{let i="string"==e.kind;if(i&&n)return!1;if(Array.isArray(e.data))for(let i of e.data)n=this.insertElement(i,t)||n;else n=this.insertElement(e.data,t)||n;return!n||!i}})},new Promise(((e,i)=>{var r=e=>{try{o(n.next(e))}catch(e){i(e)}},s=e=>{try{o(n.throw(e))}catch(e){i(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);o((n=n.apply(t,null)).next())}));var t,n}insertElement(e,t){if(e==t)return!1;if(null==t)return this.append(e),e.slot="",!0;let n;if(null==t.nextElementSibling?n=!0:null==t.previousElementSibling&&(n=!1),void 0===n&&e.parentElement==t.parentElement){let i=e.nextSibling;for(;i!=t&&null!=i;)i=i.nextSibling;n=i==t}return n?t.after(e):t.before(e),e.slot="",e.setAttribute("draggable","true"),!0}dropPlaceholderIsVisible(){return this.internals.states.has("dragover")}showDropPlaceholder(e){this.internals.states.add("dragover"),this.updateDropPlaceholder(e)}updateDropPlaceholder(e){let t=this.getFocusedElement(e);if(t)if(t instanceof HTMLElement)this.placeholder.style.left=`${t.offsetLeft}px`,this.placeholder.style.top=`${t.offsetTop}px`,this.placeholder.style.width=`${t.offsetWidth}px`,this.placeholder.style.height=`${t.offsetHeight}px`;else{let e=t.getBoundingClientRect(),n=this.getBoundingClientRect();this.placeholder.style.left=`${Math.max(n.left-e.left,0)}px`,this.placeholder.style.top=`${Math.max(n.top-e.top,0)}px`,this.placeholder.style.width=`${e.width}px`,this.placeholder.style.height=`${e.height}px`}else this.placeholder.style.left="0px",this.placeholder.style.top="0px",this.placeholder.style.width=`${this.offsetWidth}px`,this.placeholder.style.height=`${this.offsetHeight}px`}getFocusedElement(e){var t;let{previousElement:n,nextElement:i,hoveredElement:r,flowDirectionX:s}=Jn(this,this.getElements(),e.clientX,e.clientY);return null!=(t=null!=r?r:n)?t:i}getElements(){let e=[];for(let t of this.childNodes)t instanceof Element&&e.push(t);return e}hideDropPlaceholder(e){this.internals.states.delete("dragover")}connectedCallback(){super.connectedCallback()}};function tr(e){for(let t of e.childNodes)nr(t),tr(t)}function nr(e){e instanceof Element&&("value"in e&&(e instanceof HTMLTextAreaElement?e.textContent=e.value:function(e,t,n){if("string"==typeof t||"number"==t||"boolean"==t||Array.isArray(t)){let i=e.getAttribute(n),r=t.toString();i!=r&&e.setAttribute(n,r)}}(e,e.value,"value")),"checked"in e&&(e.checked?e.hasAttribute("checked")||e.setAttribute("checked",""):e.hasAttribute("checked")&&e.removeAttribute("checked")))}er=((e,t)=>{for(var n,i=t,r=e.length-1;r>=0;r--)(n=e[r])&&(i=n(i)||i);return i})([De({name:"mmr-block",template:ut`
    <slot></slot>
    <div id="placeholder" ${gt("placeholder")} part="placeholder"></div>
    `,styles:xt`
:host {
    display: block;
    position: relative;
    
    /*Set a height so we can still drop things into the :host*/
    min-height: 10px;
    min-width: 10px;
}

#placeholder {
    position: absolute;
    display: none;
    pointer-events: none;
    background: rgba(0,0, 255, 0.3);
}

:host(:state(dragover)) #placeholder,
#placeholder.dragging {
    display: block;
}
`})],er);var ir=Object.defineProperty,rr=Object.defineProperties,sr=Object.getOwnPropertyDescriptors,or=Object.getOwnPropertySymbols,ar=Object.prototype.hasOwnProperty,lr=Object.prototype.propertyIsEnumerable,dr=(e,t,n)=>t in e?ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hr=(e,t)=>{for(var n in t||(t={}))ar.call(t,n)&&dr(e,n,t[n]);if(or)for(var n of or(t))lr.call(t,n)&&dr(e,n,t[n]);return e};const cr=new Blob(['"use strict";\nconst shadowedGlobals = [\n  "AbortController",\n  "AbortSignal",\n  "globalThis ",\n  "fetch",\n  "XMLHttpRequest",\n  "self",\n  "WebSocket",\n  "importScripts",\n  "IDBDatabase",\n  "indexedDB",\n  "onmessage",\n  "postMessage",\n  "performance",\n  "navigator",\n  "caches",\n  "MessageChannel",\n  "Worker",\n  "MessagePort",\n  "addEventListener",\n  "removeEventListener",\n  "Worker",\n  "FileReader",\n  "File",\n  "Blob",\n  "setTimeout",\n  "setInterval",\n  "TextEncoder",\n  "CompressionStream",\n  "DecompressionStream",\n  "TextDecoder",\n  "TextDecoderStream",\n  "TextEncoderStream",\n  "Atomics",\n  "structuredClone",\n  "Intl",\n  "close"\n];\nArray.prototype.sum = function() {\n  let sum = 0;\n  for (let i = 0; i < this.length; i++) {\n    let num = Number(this[i]);\n    if (!Number.isNaN(num))\n      sum += num;\n  }\n  return sum;\n};\nonmessage = (e) => {\n  let data = e.data;\n  try {\n    let func = new Function(...shadowedGlobals, `return ${data.expression.transform}`);\n    const result = func.apply(data.expression.data.length == 1 ? data.expression.data[0] : data.expression.data);\n    postMessage({\n      id: data.id,\n      result\n    });\n  } catch (err) {\n    postMessage({\n      id: data.id,\n      error: err\n    });\n  }\n};\n'],{type:"text/javascript"}),ur=window.URL.createObjectURL(cr),pr="data-formula-";class gr{constructor(e){this.element=e,this.evalId=0,this.runningEvals=new Map,this.monitoredElements=new Map;let t=new MutationObserver((e=>{for(let t of e)t.target instanceof Element&&this.handleElementChange(t.target)})),n=new MutationObserver((e=>{for(let t of e){let e=t.attributeName;if(e.startsWith(pr)){let n=t.target,i=n.getAttribute(e),r=this.monitorFormula(n,e,i);r&&this.updateFormula(r)}}}));t.observe(e,{subtree:!0,childList:!0}),n.observe(e,{subtree:!0,attributes:!0,attributeOldValue:!1}),e.addEventListener("change",(e=>{e.target&&e.target instanceof Element&&this.handleElementChange(e.target)})),this.evalWorker=new Worker(ur),this.evalWorker.onmessage=e=>{let t=e.data.id,n=this.runningEvals.get(t);if(null==n?void 0:n.callbacks)if(this.runningEvals.delete(t),"error"in e.data){let t=e.data.error;n.callbacks.reject(t)}else n.callbacks.resolve(e.data.result)},this.initalise()}initalise(){let e=document.evaluate(`//*/@*[starts-with(name(), "${pr}")]`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let t=0;t<e.snapshotLength;t++){let n=e.snapshotItem(t);this.monitorFormula(n.ownerElement,n.name,n.value)}for(let[e,t]of this.monitoredElements)for(let[e,n]of t)this.checkSourcesChanged(n),this.updateFormula(n)}monitorFormula(e,t,n){var i;let r,s=fr(t);if(s)if(n)try{r=function(e){let t=/^@DOM\((('([^']+)'( *, *)?)+)\)\.select\(([^\)]+)\) *\$ *(.+)$/.exec(e);if(!t)throw new Error(`Invalid expression: ${e}`);let n=t[1].matchAll(/'([^']+)'/g),i=[];for(let e of n)i.push(e[1]);let r=t[5],s=t[6];return{queryStrings:i,property:r,propertySelector:e=>e[r],transform:s}}(n);let t={element:e,sources:yr(e,r),formula:r,property:s};return this.monitoredElements.has(e)||this.monitoredElements.set(e,new Map),null==(i=this.monitoredElements.get(e))||i.set(s,t),t}catch(e){console.error(e)}else if(this.monitoredElements.has(e)){let t=this.monitoredElements.get(e);null==t||t.delete(s),0==(null==t?void 0:t.size)&&this.monitoredElements.delete(e)}}updateFormula(e){return t=this,n=function*(){var t;try{let n=e.element,i=e.property,r=mr(i,n),s=yield this.evalFormula(e);if((null==r?void 0:r.value)==(null==(t=mr(i,n))?void 0:t.value)){let e;i in n?(e=n[i],n[i]=s):null==s||!1===s?(s=!1,e=n.hasAttribute(i),n.removeAttribute(i)):(s=s.toString(),e=n.getAttribute(i),n.setAttribute(i,s)),e!=s&&this.handleElementChange(n)}}catch(e){"object"==typeof e&&e&&"message"in e?console.error(e.message):console.error(e)}},new Promise(((e,i)=>{var r=e=>{try{o(n.next(e))}catch(e){i(e)}},s=e=>{try{o(n.throw(e))}catch(e){i(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);o((n=n.apply(t,null)).next())}));var t,n}evalFormula(e){let t={data:e.sources.map((t=>t.map(e.formula.propertySelector))),transform:e.formula.transform},n=this.evalId++,i={},r=new Promise(((e,t)=>{i.callbacks={resolve:e,reject:t}}));return this.runningEvals.set(n,i),this.evalWorker.postMessage({id:n,expression:t}),r}handleElementChange(e){for(let[t,n]of this.monitoredElements)for(let[t,i]of n)(this.checkSourcesChanged(i)||this.dependsOn(i,e))&&this.updateFormula(i);this.handleSimpleFormulaUpdate(e)}handleSimpleFormulaUpdate(e){var t;if(e instanceof Element&&this.monitoredElements.has(e))for(let n of e.attributes){let i=n.name,r=fr(i);if(r){let n=mr(r,e),s=Number(null==n?void 0:n.value);if(Number.isFinite(s)){let o=null==(t=this.monitoredElements.get(e))?void 0:t.get(r);o&&this.evalFormula(o).then((t=>{if("number"==typeof t){let d=mr(r,e);if((null==d?void 0:d.value)==(null==n?void 0:n.value)){let n=s-t;if(0!=n){let t,r=/([\+-]) *(\d+(\.\d*)?|(\.\d+)) *$/.exec(o.formula.transform),s=o.formula.transform;if(r){let e=r[0],t=r[1],i=parseFloat(r[2]);s=s.substring(0,s.length-e.length).trimEnd(),"-"==t&&(i=-i),n=i+n}t=0==n?s:n<0?`${s} ${n}`:`${s} + ${n}`;let d=(l=hr({},o.formula),`@DOM(${(a=rr(l,sr({transform:t}))).queryStrings.map((e=>`'${e}'`))}).select(${a.property}) $ ${a.transform}`);e.setAttribute(i,d)}}}var a,l}))}}}}dependsOn(e,t){return e.sources.some((e=>e.includes(t)))}checkSourcesChanged(e){let t=yr(e.element,e.formula);if(t.length!=e.sources.length)return e.sources=t,!0;for(let n=0;n<t.length;n++){if(t[n].length!=e.sources[n].length)return e.sources=t,!0;for(let i=0;i<t[n].length;i++)if(t[n][i]!=e.sources[n][i])return e.sources=t,!0}return!1}}function fr(e){return e.startsWith(pr)?e.substring(13):null}function mr(e,t){return e in t?{value:t[e]}:null}const vr=/^closest\(([^\)]+)\)(.+)/i,br=/^>/i;function yr(e,t){return t.queryStrings.map((t=>{let n,i=vr.exec(t);if(i){let t=i[1],r=i[2],s=e.closest(t);n=null==s?void 0:s.querySelectorAll(r)}else n=br.test(t)?e.querySelectorAll(t):document.querySelectorAll(t);return n?Array.from(n).filter((e=>e instanceof Element)):[]}))}window.myHooks={saveWebPageOnExitHook:function(){window.addEventListener("beforeunload",(e=>{tr(document.documentElement);const t=document.documentElement.innerHTML;try{localStorage.setItem(`page:${location.pathname}`,t)}catch(t){alert("Unable to save page to locale storage"),e.preventDefault()}}))},loadWebPageOnLoadHook:function(){window.addEventListener("load",(()=>{let e=localStorage.getItem(`page:${location.pathname}`);e&&confirm("Restore page from last session?")&&(document.documentElement.innerHTML=e)}))},saveWebPageHook:function(){document.addEventListener("keydown",(e=>{if((e.ctrlKey||e.metaKey)&&"s"===e.key){e.preventDefault(),tr(document.documentElement);const t=new Blob([document.documentElement.outerHTML],{type:"text/html"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n;let r=new URL(location.href),s=r.pathname.split("/"),o=s[s.length-1];o&&o.length>0?o.endsWith(".html")||(o=`${o}.html`):o=`${r.hostname}.html`,i.download=o,i.style.display="none",document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),i.remove()}}))},monitorDataFormulas:e=>new gr(e)}})();